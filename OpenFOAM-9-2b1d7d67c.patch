 Allwmake                                           |   5 +-
 applications/Allwmake                              |   2 +
 .../fluent3DMeshToFoam/fluent3DMeshToFoam.L        |   4 +-
 .../utilities/mesh/generation/foamyMesh/Allwmake   |   7 +-
 .../DelaunayMesh/DelaunayMesh.C                    |   7 +-
 .../DelaunayMesh/DistributedDelaunayMesh.C         |   7 +-
 .../foamyMesh/conformalVoronoiMesh/Make/options    |   1 +
 .../cellShapeControlMesh/cellShapeControlMesh.H    |   7 ++
 .../CGALTriangulation3DKernel.H                    |   5 +
 .../generation/foamyMesh/foamyHexMesh/Make/options |   1 +
 .../foamyMesh/foamyQuadMesh/Make/options           |   1 +
 .../foamyQuadMesh/insertSurfaceNearestPointPairs.C |   2 +-
 .../mesh/manipulation/renumberMesh/Allwmake        |   9 +-
 .../postProcessing/graphics/PVReaders/Allwmake     |   6 +
 bin/foamMonitor                                    |  15 ++-
 bin/paraFoam                                       |   6 +
 bin/tools/RunFunctions                             |   3 +
 etc/bashrc                                         |  66 ++++++++--
 etc/config.csh/mac/paraview                        |  13 ++
 etc/config.csh/mpi                                 |   7 +-
 etc/config.csh/settings                            |  27 ++++-
 etc/config.csh/unset                               |  36 ++++--
 etc/config.sh/mac/CGAL                             |  47 ++++++++
 etc/config.sh/mac/functions                        | 134 +++++++++++++++++++++
 etc/config.sh/mac/metis                            |  44 +++++++
 etc/config.sh/mac/paraview                         |  18 +++
 etc/config.sh/mac/scotch                           |  47 ++++++++
 etc/config.sh/mpi                                  |   5 +-
 etc/config.sh/settings                             |  18 ++-
 etc/config.sh/unset                                |  25 +++-
 etc/cshrc                                          |  55 +++++++--
 src/Allwmake                                       |   2 +
 src/OSspecific/POSIX/POSIX.C                       |  33 +++++
 src/OSspecific/POSIX/clockTime/clockTime.H         |   3 +
 src/OSspecific/POSIX/fileStat.C                    |   2 +
 src/OSspecific/POSIX/printStack.C                  |  43 ++++++-
 src/OSspecific/POSIX/signals/sigFpe.C              |  79 +++++++++++-
 src/OSspecific/POSIX/signals/sigFpe.H              |  12 +-
 src/OpenFOAM/Make/files                            |   2 +
 src/OpenFOAM/containers/Lists/UList/UList.C        |   3 +-
 .../db/dynamicLibrary/dynamicCode/dynamicCode.C    |   4 +
 .../db/dynamicLibrary/dynamicCode/dynamicCode.H    |   4 +
 src/OpenFOAM/primitives/Scalar/doubleFloat.H       |  40 ++++++
 src/OpenFOAM/primitives/hashes/Hasher/Hasher.C     |   2 +-
 src/OpenFOAM/primitives/ints/int16/int16.C         |  48 ++++++++
 src/OpenFOAM/primitives/ints/int16/int16.H         |  73 +++++++++++
 src/OpenFOAM/primitives/ints/int64/int64.H         |   5 +
 src/OpenFOAM/primitives/ints/int64/int64IO.C       |  12 ++
 src/OpenFOAM/primitives/ints/uint/uint.H           |   1 +
 src/OpenFOAM/primitives/ints/uint16/uint16.C       |  48 ++++++++
 src/OpenFOAM/primitives/ints/uint16/uint16.H       |  73 +++++++++++
 src/OpenFOAM/primitives/ints/uint64/uint64.H       |   4 +
 src/OpenFOAM/primitives/ints/uint64/uint64IO.C     |   8 ++
 src/OpenFOAM/primitives/strings/word/wordIOList.C  |   2 +-
 src/fvAgglomerationMethods/Allwmake                |  10 +-
 .../MGridGenGamgAgglomeration/Make/options         |  14 ++-
 src/parallel/decompose/Allwmake                    |   5 +-
 src/parallel/decompose/metisDecomp/Allwmake        |  14 ++-
 src/parallel/decompose/ptscotchDecomp/Make/options |  16 +--
 src/parallel/decompose/scotchDecomp/Make/options   |  10 +-
 src/renumber/SloanRenumber/Make/options            |  14 ++-
 .../basic/basicThermo/basicThermo.C                |   2 +-
 wmake/makefiles/general                            |   4 +
 wmake/rules/General/transform                      |   1 -
 wmake/rules/darwin64Clang/CGAL                     |   9 ++
 wmake/rules/darwin64Clang/bison                    |  13 ++
 wmake/rules/darwin64Clang/c                        |  23 ++++
 wmake/rules/darwin64Clang/c++                      |  35 ++++++
 wmake/rules/darwin64Clang/c++Debug                 |   4 +
 wmake/rules/darwin64Clang/c++Opt                   |   5 +
 wmake/rules/darwin64Clang/c++Prof                  |   4 +
 wmake/rules/darwin64Clang/cDebug                   |   4 +
 wmake/rules/darwin64Clang/cOpt                     |   4 +
 wmake/rules/darwin64Clang/cProf                    |   4 +
 wmake/rules/darwin64Clang/flex                     |   5 +
 wmake/rules/darwin64Clang/flex++                   |   5 +
 wmake/rules/darwin64Clang/general                  |  16 +++
 wmake/rules/darwin64Clang/yacc                     |  13 ++
 wmake/src/Makefile                                 |   2 +
 wmake/wmake                                        |   5 +
 wmake/wmakeLnIncludeAll                            |   1 +
 81 files changed, 1276 insertions(+), 99 deletions(-)

diff --git a/Allwmake b/Allwmake
index 3f6a7523d..00810aff6 100755
--- a/Allwmake
+++ b/Allwmake
@@ -12,11 +12,13 @@ wmakeCheckPwd "$WM_PROJECT_DIR" || {
     exit 1
 }
 
+[ "$(uname -s)" = "Darwin" ] || {
 [ -n "$FOAM_EXT_LIBBIN" ] || {
     echo "Allwmake error: FOAM_EXT_LIBBIN not set"
     echo "    Check the OpenFOAM entries in your dot-files and source them."
     exit 1
 }
+}
 
 # Compile wmake support applications
 (cd wmake/src && make)
@@ -26,7 +28,8 @@ if [ -d "$WM_THIRD_PARTY_DIR" ]
 then
     $WM_THIRD_PARTY_DIR/Allwmake
 else
-    echo "Allwmake: no ThirdParty directory found - skipping"
+    [ "$(uname -s)" = "Darwin" ] \
+        || echo "Allwmake: no ThirdParty directory found - skipping"
 fi
 
 # Compile OpenFOAM libraries and applications
diff --git a/applications/Allwmake b/applications/Allwmake
index 2b725832b..8f96f6ec1 100755
--- a/applications/Allwmake
+++ b/applications/Allwmake
@@ -12,11 +12,13 @@ wmakeCheckPwd "$WM_PROJECT_DIR/applications" || {
     exit 1
 }
 
+[ "$(uname -s)" = "Darwin" ] || {
 [ -n "$FOAM_EXT_LIBBIN" ] || {
     echo "Allwmake error: FOAM_EXT_LIBBIN not set"
     echo "    Check the OpenFOAM entries in your dot-files and source them."
     exit 1
 }
+}
 
 wmake -all $targetType solvers
 wmake -all $targetType utilities
diff --git a/applications/utilities/mesh/conversion/fluent3DMeshToFoam/fluent3DMeshToFoam.L b/applications/utilities/mesh/conversion/fluent3DMeshToFoam/fluent3DMeshToFoam.L
index 1a7c40741..83676bac7 100644
--- a/applications/utilities/mesh/conversion/fluent3DMeshToFoam/fluent3DMeshToFoam.L
+++ b/applications/utilities/mesh/conversion/fluent3DMeshToFoam/fluent3DMeshToFoam.L
@@ -1076,8 +1076,8 @@ int main(int argc, char *argv[])
                             if
                             (
                                 nbrType != type
-                             && nbrName(min(name.size(), nbrName.size()))
-                             == name(min(name.size(), nbrName.size()))
+                             && nbrName(std::min(name.size(), nbrName.size()))
+                             == name(std::min(name.size(), nbrName.size()))
                             )
                             {
                                 nbrPatchis[nbrPatchi] = patchi;
diff --git a/applications/utilities/mesh/generation/foamyMesh/Allwmake b/applications/utilities/mesh/generation/foamyMesh/Allwmake
index 273a56e5f..0ca85d92f 100755
--- a/applications/utilities/mesh/generation/foamyMesh/Allwmake
+++ b/applications/utilities/mesh/generation/foamyMesh/Allwmake
@@ -4,8 +4,11 @@ cd ${0%/*} || exit 1    # Run from this directory
 # Parse arguments for library compilation
 . $WM_PROJECT_DIR/wmake/scripts/AllwmakeParseArguments
 
+CGAL_CONF_FILE=config.sh/CGAL
+[ $(uname -s) ] && CGAL_CONF_FILE=config.sh/mac/CGAL
+
 # Get BOOST_ARCH_PATH, CGAL_ARCH_PATH
-if settings=`$WM_PROJECT_DIR/bin/foamEtcFile config.sh/CGAL`
+if settings=`$WM_PROJECT_DIR/bin/foamEtcFile $CGAL_CONF_FILE`
 then
     . $settings
     if [ -n "$BOOST_ARCH_PATH" ]
@@ -31,4 +34,6 @@ wmake $targetType foamyHexMesh
 #(cd foamyHexMeshSurfaceSimplify && ./Allwmake $targetType $*)
 #wmake $targetType cellSizeAndAlignmentGrid
 
+unset CGAL_CONF_FILE
+
 #------------------------------------------------------------------------------
diff --git a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DelaunayMesh.C b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DelaunayMesh.C
index 73a3323d3..7b1a6b466 100644
--- a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DelaunayMesh.C
+++ b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DelaunayMesh.C
@@ -24,6 +24,9 @@ License
 \*---------------------------------------------------------------------------*/
 
 #include "DelaunayMesh.H"
+
+#include <random>
+
 #include "labelPair.H"
 #include "PrintTable.H"
 #include "pointIOField.H"
@@ -302,7 +305,9 @@ Foam::Map<Foam::label> Foam::DelaunayMesh<Triangulation>::rangeInsertWithInfo
         );
     }
 
-    std::random_shuffle(points.begin(), points.end());
+    std::random_device rng;
+    std::mt19937 urng(rng());
+    std::shuffle(points.begin(), points.end(), urng);
 
     spatial_sort
     (
diff --git a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DistributedDelaunayMesh.C b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DistributedDelaunayMesh.C
index 0b59e0ead..ddbf3c175 100644
--- a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DistributedDelaunayMesh.C
+++ b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/DelaunayMesh/DistributedDelaunayMesh.C
@@ -24,6 +24,9 @@ License
 \*---------------------------------------------------------------------------*/
 
 #include "DistributedDelaunayMesh.H"
+
+#include <random>
+
 #include "meshSearch.H"
 #include "mapDistribute.H"
 #include "zeroGradientFvPatchFields.H"
@@ -900,7 +903,9 @@ Foam::DistributedDelaunayMesh<Triangulation>::rangeInsertReferredWithInfo
         );
     }
 
-    std::random_shuffle(pointsBbDistSqr.begin(), pointsBbDistSqr.end());
+    std::random_device rng;
+    std::mt19937 urng(rng());
+    std::shuffle(pointsBbDistSqr.begin(), pointsBbDistSqr.end(), urng);
 
     // Sort in ascending order by the distance of the point from the centre
     // of the processor bounding box
diff --git a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/Make/options b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/Make/options
index 3102dfc3e..297498412 100644
--- a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/Make/options
+++ b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/Make/options
@@ -6,6 +6,7 @@ CGAL_EXACT =
 CGAL_INEXACT = -DCGAL_INEXACT
 
 include $(GENERAL_RULES)/CGAL
+-include $(RULES)/CGAL
 
 EXE_INC = \
     ${ROUNDING_MATH} \
diff --git a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/cellShapeControl/cellShapeControlMesh/cellShapeControlMesh.H b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/cellShapeControl/cellShapeControlMesh/cellShapeControlMesh.H
index 9bffa7810..843b2357d 100644
--- a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/cellShapeControl/cellShapeControlMesh/cellShapeControlMesh.H
+++ b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/cellShapeControl/cellShapeControlMesh/cellShapeControlMesh.H
@@ -43,7 +43,14 @@ SourceFiles
 #include "fileName.H"
 #include "searchableSurfaces.H"
 #include "conformationSurfaces.H"
+
+#pragma clang diagnostic push
+#pragma clang diagnostic ignored "-W#pragma-messages"
+
 #include "DistributedDelaunayMesh.H"
+
+#pragma clang diagnostic pop
+
 #include "CGALTriangulation3Ddefs.H"
 #include "backgroundMeshDecomposition.H"
 #include "boundBox.H"
diff --git a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/conformalVoronoiMesh/CGALTriangulation3DKernel.H b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/conformalVoronoiMesh/CGALTriangulation3DKernel.H
index 2f53d51e0..bad8b4ff1 100644
--- a/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/conformalVoronoiMesh/CGALTriangulation3DKernel.H
+++ b/applications/utilities/mesh/generation/foamyMesh/conformalVoronoiMesh/conformalVoronoiMesh/CGALTriangulation3DKernel.H
@@ -33,6 +33,9 @@ Description
 
 // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
 
+#pragma clang diagnostic push
+#pragma clang diagnostic ignored "-W#pragma-messages"
+
 #include "CGAL/Delaunay_triangulation_3.h"
 
 #ifdef CGAL_INEXACT
@@ -60,6 +63,8 @@ Description
 
 // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
 
+#pragma clang diagnostic pop
+
 #endif
 
 // ************************************************************************* //
diff --git a/applications/utilities/mesh/generation/foamyMesh/foamyHexMesh/Make/options b/applications/utilities/mesh/generation/foamyMesh/foamyHexMesh/Make/options
index 804498da0..7ddef6f21 100644
--- a/applications/utilities/mesh/generation/foamyMesh/foamyHexMesh/Make/options
+++ b/applications/utilities/mesh/generation/foamyMesh/foamyHexMesh/Make/options
@@ -6,6 +6,7 @@ CGAL_EXACT =
 CGAL_INEXACT = -DCGAL_INEXACT
 
 include $(GENERAL_RULES)/CGAL
+-include $(RULES)/CGAL
 
 EXE_INC = \
     ${ROUNDING_MATH} \
diff --git a/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/Make/options b/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/Make/options
index 37dda1856..28ecb42c8 100644
--- a/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/Make/options
+++ b/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/Make/options
@@ -2,6 +2,7 @@ EXE_DEBUG = -DFULLDEBUG -g -O0
 EXE_NDEBUG = -DNDEBUG
 
 include $(GENERAL_RULES)/CGAL
+-include $(RULES)/CGAL
 
 EXE_INC = \
     ${ROUNDING_MATH} \
diff --git a/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/insertSurfaceNearestPointPairs.C b/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/insertSurfaceNearestPointPairs.C
index 48d9ed870..843f28abd 100644
--- a/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/insertSurfaceNearestPointPairs.C
+++ b/applications/utilities/mesh/generation/foamyMesh/foamyQuadMesh/insertSurfaceNearestPointPairs.C
@@ -142,7 +142,7 @@ void Foam::CV2D::insertSurfaceNearestPointPairs()
     Info<< "insertSurfaceNearestPointPairs: ";
 
     label nSurfacePointsEst =
-        min
+        std::min
         (
             number_of_vertices(),
             size_t(10*sqrt(scalar(number_of_vertices())))
diff --git a/applications/utilities/mesh/manipulation/renumberMesh/Allwmake b/applications/utilities/mesh/manipulation/renumberMesh/Allwmake
index ee135cc37..1d3f69f2b 100755
--- a/applications/utilities/mesh/manipulation/renumberMesh/Allwmake
+++ b/applications/utilities/mesh/manipulation/renumberMesh/Allwmake
@@ -4,22 +4,29 @@ cd ${0%/*} || exit 1    # Run from this directory
 # Parse arguments for compilation (at least for error catching)
 . $WM_PROJECT_DIR/wmake/scripts/AllwmakeParseArguments
 
+_soExt=so
+[ "$(uname -s)" = "Darwin" ] && _soExt=dylib
+
 export COMPILE_FLAGS=''
 export LINK_FLAGS=''
 
-if [ -f "${FOAM_LIBBIN}/libSloanRenumber.so" ]
+if [ -f "${FOAM_LIBBIN}/libSloanRenumber.$_soExt" ]
 then
     echo "Found libSloanRenumber.so  --  enabling Sloan renumbering support."
     export LINK_FLAGS="${LINK_FLAGS} -lSloanRenumber"
 fi
 
+[ -n "$ZOLTAN_ARCH_PATH" ] && {
 if [ -f "${ZOLTAN_ARCH_PATH}/lib/libzoltan.a" -a -f "${FOAM_LIBBIN}/libzoltanRenumber.so" ]
 then
     echo "Found libzoltanRenumber.so  --  enabling zoltan renumbering support."
     export COMPILE_FLAGS="-DFOAM_USE_ZOLTAN"
     export LINK_FLAGS="${LINK_FLAGS} -lzoltanRenumber -L${ZOLTAN_ARCH_PATH}/lib -lzoltan"
 fi
+}
 
 wmake $targetType
 
+unset _soExt
+
 #------------------------------------------------------------------------------
diff --git a/applications/utilities/postProcessing/graphics/PVReaders/Allwmake b/applications/utilities/postProcessing/graphics/PVReaders/Allwmake
index f270c064b..7e474f909 100755
--- a/applications/utilities/postProcessing/graphics/PVReaders/Allwmake
+++ b/applications/utilities/postProcessing/graphics/PVReaders/Allwmake
@@ -4,6 +4,12 @@ cd ${0%/*} || exit 1    # Run from this directory
 # Parse arguments for library compilation
 . $WM_PROJECT_DIR/wmake/scripts/AllwmakeParseArguments
 
+if [ "$(uname -s)" = "Darwin" ]
+then
+    echo "Skipping PVReaders on macOS."
+    exit 0
+fi
+
 if [ ! -d "$ParaView_DIR" ]
 then
     echo "    Warning: ParaView not found in $ParaView_DIR. Skipping."
diff --git a/bin/foamMonitor b/bin/foamMonitor
index 32b62d792..603771302 100755
--- a/bin/foamMonitor
+++ b/bin/foamMonitor
@@ -64,9 +64,14 @@ error() {
 
 plotFileHeader() {
     cat<<EOF
-set term $gpterminal $size
+selected_terminal = 'x11'
+for [t in "wxt qt"] if (strstrt(GPVAL_TERMINALS, t)) selected_terminal = t
+set term selected_terminal $gpterminal $size
 $logscale
+$explabels
 $yrange
+set size ratio 0.62111801242236
+set grid
 set ytics format "$yticFormat"
 set title "$title"
 set xlabel "$xlabel"
@@ -92,13 +97,16 @@ isInteger() {
 idle=60
 refresh=10
 logscale=""
+explabels=""
 yrange=""
 yticFormat="%g"
 title="Data Monitoring"
 size=""
-gpterminal='x11 1 font "helvetica,17" linewidth 1.5 persist noraise'
+gpterminal='1 font "helvetica,17" linewidth 1.5 persist noraise'
 
 command -v gnuplot >/dev/null 2>&1 || error "Gnuplot not installed"
+STAT="stat --format=%Y"
+[ "$(uname -s)" = "Darwin" ] && STAT="stat -f %m"
 
 # parse options
 while [ "$#" -gt 0 ]
@@ -114,6 +122,7 @@ do
         ;;
     -l | -logscale)
         logscale="set logscale y"
+	explabels='set format y "%.1g"'
         yticFormat="%1.e"
         shift 1
         ;;
@@ -202,7 +211,7 @@ pid=$!
 
 while true
 do
-    mod_time=$(stat --format=%Y "$file")
+    mod_time=$($STAT "$file")
     idle_ago=$(( $(date +%s) - idle ))
     test "$mod_time" -gt "$idle_ago" || break
     sleep "$refresh"
diff --git a/bin/paraFoam b/bin/paraFoam
index 78911fdce..d70dc4bf9 100755
--- a/bin/paraFoam
+++ b/bin/paraFoam
@@ -101,6 +101,12 @@ extension=OpenFOAM
 
 requirePV=1
 
+if [ "$(uname -s)" = "Darwin" ]
+then
+    extension=foam
+    requirePV=0
+fi
+
 # Parse options
 while [ "$#" -gt 0 ]
 do
diff --git a/bin/tools/RunFunctions b/bin/tools/RunFunctions
index 1a040df6a..67a2ef2b9 100644
--- a/bin/tools/RunFunctions
+++ b/bin/tools/RunFunctions
@@ -28,6 +28,9 @@
 #     Miscellaneous functions for running tutorial cases
 #------------------------------------------------------------------------------
 
+[ -z "$DYLD_LIBRARY_PATH" -a -n "$FOAM_DYLD_LIBRARY_PATH" ] \
+    && export DYLD_LIBRARY_PATH="$FOAM_DYLD_LIBRARY_PATH"
+
 isTest()
 {
     for i in "$@"; do
diff --git a/etc/bashrc b/etc/bashrc
index 9759c9f2b..18f1cdae8 100644
--- a/etc/bashrc
+++ b/etc/bashrc
@@ -52,6 +52,16 @@ export FOAM_INST_DIR=$HOME/$WM_PROJECT
 # END OF (NORMAL) USER EDITABLE PART
 ################################################################################
 
+_foam_on_macos()
+{
+    if [ "$(uname -s)" = "Darwin" ]
+    then
+        return 0
+    else
+        return 1
+    fi
+}
+
 # The default environment variables below can be overridden in a prefs.sh file
 # located in ~/.OpenFOAM/$WM_PROJECT_VERSION, ~/.OpenFOAM,
 # $FOAM_INST_DIR/site/$WM_PROJECT_VERSION or $FOAM_INST_DIR/site
@@ -62,7 +72,7 @@ export WM_COMPILER_TYPE=system
 
 #- Compiler:
 #    WM_COMPILER = Gcc | Gcc48 ... Gcc62 | Clang | Icc
-export WM_COMPILER=Gcc
+export WM_COMPILER=Clang
 unset WM_COMPILER_ARCH WM_COMPILER_LIB_ARCH
 
 #- Memory addressing:
@@ -125,7 +135,8 @@ fi
 
 # Location of third-party software
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-export WM_THIRD_PARTY_DIR=$WM_PROJECT_INST_DIR/ThirdParty-$WM_PROJECT_VERSION
+_foam_on_macos \
+    || export WM_THIRD_PARTY_DIR=$WM_PROJECT_INST_DIR/ThirdParty-$WM_PROJECT_VERSION
 
 if [ -d "$WM_THIRD_PARTY_DIR" ]
 then
@@ -154,9 +165,10 @@ export WM_PROJECT_USER_DIR=$HOME/$WM_PROJECT/$USER-$WM_PROJECT_VERSION
 # Source initialisation functions
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 . $WM_PROJECT_DIR/etc/config.sh/functions
+_foam_on_macos && . $WM_PROJECT_DIR/etc/config.sh/mac/functions
 
 # Add in preset user or site preferences:
-_foamSource `$WM_PROJECT_DIR/bin/foamEtcFile prefs.sh`
+_foamSource $($WM_PROJECT_DIR/bin/foamEtcFile prefs.sh)
 
 # Evaluate command-line parameters of the form "param=keyword" or unset
 # parameters with "param="
@@ -168,16 +180,27 @@ _foamParams $@
 foamClean=$WM_PROJECT_DIR/bin/foamCleanPath
 
 #- Clean PATH
-cleaned=`$foamClean "$PATH" "$foamOldDirs"` && PATH="$cleaned"
+cleaned=$($foamClean "$PATH" "$foamOldDirs") && PATH="$cleaned"
 
-#- Clean LD_LIBRARY_PATH
-cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"` \
-    && LD_LIBRARY_PATH="$cleaned"
+if _foam_on_macos
+then
+    #- Clean DYLD_LIBRARY_PATH on macOS
+    cleaned=$($foamClean "$DYLD_LIBRARY_PATH" "$foamOldDirs") \
+        && DYLD_LIBRARY_PATH="$cleaned"
+    export DYLD_LIBRARY_PATH
+    FOAM_DYLD_LIBRARY_PATH="$DYDL_LIBRARY_PATH"
+    export FOAM_DYLD_LIBRARY_PATH
+else
+    #- Clean LD_LIBRARY_PATH
+    cleaned=$($foamClean "$LD_LIBRARY_PATH" "$foamOldDirs") \
+        && LD_LIBRARY_PATH="$cleaned"
+    export LD_LIBRARY_PATH
+fi
 
 #- Clean MANPATH
-cleaned=`$foamClean "$MANPATH" "$foamOldDirs"` && MANPATH="$cleaned"
+cleaned=$($foamClean "$MANPATH" "$foamOldDirs") && MANPATH="$cleaned"
 
-export PATH LD_LIBRARY_PATH MANPATH
+export PATH MANPATH
 
 
 # Source project setup files
@@ -189,7 +212,12 @@ _foamSource $WM_PROJECT_DIR/etc/config.sh/aliases
 # Source user setup files for optional packages
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/mpi`
-_foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/paraview`
+if _foam_on_macos
+then
+    _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/mac/paraview`
+else
+    _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/paraview`
+fi
 _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/ensight`
 _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/gperftools`
 
@@ -199,13 +227,23 @@ _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.sh/gperftools`
 #- Clean PATH
 cleaned=`$foamClean "$PATH"` && PATH="$cleaned"
 
-#- Clean LD_LIBRARY_PATH
-cleaned=`$foamClean "$LD_LIBRARY_PATH"` && LD_LIBRARY_PATH="$cleaned"
+if _foam_on_macos
+then
+    #- Clean DYLD_LIBRARY_PATH
+    cleaned=`$foamClean "$DYLD_LIBRARY_PATH"` && DYLD_LIBRARY_PATH="$cleaned"
+    export DYLD_LIBRARY_PATH
+    FOAM_DYLD_LIBRARY_PATH="$DYLD_LIBRARY_PATH"
+    export FOAM_DYLD_LIBRARY_PATH
+else
+    #- Clean LD_LIBRARY_PATH
+    cleaned=`$foamClean "$LD_LIBRARY_PATH"` && LD_LIBRARY_PATH="$cleaned"
+    export LD_LIBRARY_PATH
+fi
 
 #- Clean MANPATH (trailing ':' to find system pages)
 cleaned=`$foamClean "$MANPATH"`: && MANPATH="$cleaned"
 
-export PATH LD_LIBRARY_PATH MANPATH
+export PATH MANPATH
 
 #- Clean LD_PRELOAD
 if [ -n "$LD_PRELOAD" ]
@@ -224,6 +262,8 @@ unset cleaned foamClean foamOldDirs
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 . $WM_PROJECT_DIR/etc/config.sh/functions
 
+_foam_on_macos && . $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
 # Source the bash completion file:
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 [ "$BASH" ] && . $WM_PROJECT_DIR/etc/config.sh/bash_completion
diff --git a/etc/config.csh/mac/paraview b/etc/config.csh/mac/paraview
new file mode 100644
index 000000000..53adbcca5
--- /dev/null
+++ b/etc/config.csh/mac/paraview
@@ -0,0 +1,13 @@
+set _paraview = /Applications/[Pp][Aa][Rr][Aa][Vv][Ii][Ee][Ww]*.app
+if ( -d $_paraview ) then
+    if ( $?prompt ) echo Using $_paraview
+    alias paraview "$_paraview/Contents/MacOS/paraview"
+else
+    echo
+    echo "Please download binary Paraview release from"
+    echo "http://paraview.org and install it in /Applications"
+    echo "folder."
+    echo
+endif
+
+#----------------------------- vi: set ft=csh et: ----------------------------
diff --git a/etc/config.csh/mpi b/etc/config.csh/mpi
index 78b14e474..db7040a51 100644
--- a/etc/config.csh/mpi
+++ b/etc/config.csh/mpi
@@ -262,7 +262,10 @@ endsw
 # Add (non-dummy) MPI implementation
 # Dummy MPI already added to LD_LIBRARY_PATH and has no external libraries
 if ( "$FOAM_MPI" != dummy ) then
-    _foamAddLib ${FOAM_LIBBIN}/${FOAM_MPI}:${FOAM_EXT_LIBBIN}/${FOAM_MPI}
+    if ($?FOAM_EXT_LIBBIN) then
+        _foamAddLib :${FOAM_EXT_LIBBIN}/${FOAM_MPI}
+    endif
+    _foamAddLib ${FOAM_LIBBIN}/${FOAM_MPI}
 endif
 
 
@@ -279,4 +282,4 @@ else
     setenv MPI_BUFFER_SIZE $minBufferSize
 endif
 
-#------------------------------------------------------------------------------
+#-------------------- vi: set ft=tcsh et sw=4 ts=4 sts=4: ---------------------
diff --git a/etc/config.csh/settings b/etc/config.csh/settings
index f7cf4020c..580667000 100644
--- a/etc/config.csh/settings
+++ b/etc/config.csh/settings
@@ -32,8 +32,12 @@
 
 # Prefix to PATH
 alias _foamAddPath 'setenv PATH \!*\:${PATH}'
-# Prefix to LD_LIBRARY_PATH
-alias _foamAddLib 'setenv LD_LIBRARY_PATH \!*\:${LD_LIBRARY_PATH}'
+# Prefix to [FOAM_][DY]LD_LIBRARY_PATH
+if ($foamDarwin) then
+    alias _foamAddLib 'setenv FOAM_DYLD_LIBRARY_PATH \!*\:${FOAM_DYLD_LIBRARY_PATH}; setenv DYLD_LIBRARY_PATH \!*\:${DYLD_LIBRARY_PATH}'
+else
+    alias _foamAddLib 'setenv LD_LIBRARY_PATH \!*\:${LD_LIBRARY_PATH}'
+endif
 # Prefix to MANPATH
 alias _foamAddMan 'setenv MANPATH \!*\:${MANPATH}'
 
@@ -129,6 +133,13 @@ case SunOS:
     setenv WM_LDFLAGS '-mabi=64 -G0'
     breaksw
 
+case Darwin:
+    setenv WM_ARCH darwin64
+    setenv WM_COMPILER_LIB_ARCH 64
+    setenv WM_CC 'clang'
+    setenv WM_CXX 'clang++'
+    breaksw
+
 default:
     echo
     echo "Your '$WM_ARCH' operating system is not supported by this release"
@@ -155,7 +166,9 @@ setenv FOAM_APPBIN $WM_PROJECT_DIR/platforms/$WM_OPTIONS/bin
 setenv FOAM_LIBBIN $WM_PROJECT_DIR/platforms/$WM_OPTIONS/lib
 
 # External (ThirdParty) libraries
-setenv FOAM_EXT_LIBBIN $WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/lib
+if (${?WM_THIRD_PARTY_DIR}) then
+    setenv FOAM_EXT_LIBBIN $WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/lib
+endif
 
 # Site-specific directory
 if ( $?WM_PROJECT_SITE ) then
@@ -202,7 +215,11 @@ unset siteDir
 
 _foamAddPath ${FOAM_USER_APPBIN}:${FOAM_SITE_APPBIN}:${FOAM_APPBIN}
 # Make sure to pick up dummy versions of external libraries last
-_foamAddLib  ${FOAM_USER_LIBBIN}:${FOAM_SITE_LIBBIN}:${FOAM_LIBBIN}:${FOAM_EXT_LIBBIN}:${FOAM_LIBBIN}/dummy
+_foamAddLib ${FOAM_LIBBIN}/dummy
+if (${?FOAM_EXT_LIBBIN}) then
+    _foamAddLib ${FOAM_EXT_LIBBIN}
+endif
+_foamAddLib  ${FOAM_USER_LIBBIN}:${FOAM_SITE_LIBBIN}:${FOAM_LIBBIN}
 
 # Compiler settings
 # ~~~~~~~~~~~~~~~~~
@@ -341,4 +358,4 @@ endsw
 unset minBufferSize
 unsetenv WM_COMPILER_TYPE
 
-#------------------------------------------------------------------------------
+#-------------------- vi: set ft=tcsh et sw=4 ts=4 sts=4: ---------------------
diff --git a/etc/config.csh/unset b/etc/config.csh/unset
index 6e4a95e92..1d2166bcf 100644
--- a/etc/config.csh/unset
+++ b/etc/config.csh/unset
@@ -29,6 +29,8 @@
 #
 #------------------------------------------------------------------------------
 
+@ foamDarwin = (`uname -s` == "Darwin")
+
 # Clean standard environment variables (PATH, LD_LIBRARY_PATH, MANPATH)
 
 unset foamClean
@@ -38,7 +40,10 @@ if ( $?WM_PROJECT_DIR ) then
 endif
 
 # The old dirs to be cleaned from the environment variables
-set foamOldDirs="$WM_PROJECT_DIR $WM_THIRD_PARTY_DIR $HOME/$WM_PROJECT/$LOGNAME $FOAM_SITE_APPBIN $FOAM_SITE_LIBBIN"
+set foamOldDirs="$WM_PROJECT_DIR $HOME/$WM_PROJECT/$LOGNAME $FOAM_SITE_APPBIN $FOAM_SITE_LIBBIN"
+if ( ${?WM_THIRD_PARTY_DIR} ) then
+   set foamOldDirs="$foamOldDirs $WM_THIRD_PARTY_DIR"
+endif
 if ( $?WM_PROJECT_SITE ) then
    set foamOldDirs="$foamOldDirs $WM_PROJECT_SITE"
 endif
@@ -55,6 +60,7 @@ unsetenv WM_ARCH_OPTION
 unsetenv WM_CC
 unsetenv WM_CFLAGS
 unsetenv WM_COMPILER
+unsetenv WM_COMPILER_ARCH
 unsetenv WM_COMPILER_TYPE
 unsetenv WM_COMPILER_LIB_ARCH
 unsetenv WM_COMPILE_OPTION
@@ -78,7 +84,8 @@ unsetenv WM_PROJECT_SITE
 unsetenv WM_PROJECT_USER_DIR
 unsetenv WM_PROJECT_VERSION
 unsetenv WM_SCHEDULER
-unsetenv WM_THIRD_PARTY_DIR
+if ($?WM_THIRD_PARTY_DIR) \
+    unsetenv WM_THIRD_PARTY_DIR
 
 
 #------------------------------------------------------------------------------
@@ -144,11 +151,21 @@ if ( $?foamClean ) then
     set cleaned=`$foamClean "$PATH" "$foamOldDirs"`
     if ( $status == 0 ) setenv PATH $cleaned
 
-    if ($?LD_LIBRARY_PATH) then
-        set cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"`
-        if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
-
-        if ( ${%LD_LIBRARY_PATH} == 0 ) unsetenv LD_LIBRARY_PATH
+    if ($foamDarwin) then
+        if ($?FOAM_DYLD_LIBRARY_PATH) then
+            set cleaned=`$foamClean "$FOAM_DYLD_LIBRARY_PATH" "$foamOldDirs"`
+            if ( $status == 0 ) setenv DYLD_LIBRARY_PATH $cleaned
+
+            if ( ${%DYLD_LIBRARY_PATH} == 0 ) unsetenv DYLD_LIBRARY_PATH
+            unsetenv FOAM_DYLD_LIBRARY_PATH
+        endif
+    else
+        if ($?LD_LIBRARY_PATH) then
+            set cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"`
+            if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
+
+            if ( ${%LD_LIBRARY_PATH} == 0 ) unsetenv LD_LIBRARY_PATH
+        endif
     endif
 
     if ($?MANPATH) then
@@ -161,7 +178,7 @@ if ( $?foamClean ) then
 endif
 
 
-unset cleaned foamClean foamOldDirs
+unset cleaned foamClean foamOldDirs foamDarwin
 
 #------------------------------------------------------------------------------
 # Cleanup aliases
@@ -171,6 +188,7 @@ unalias wm64
 unalias wm32
 unalias wmSP
 unalias wmDP
+unalias wmLP
 
 unalias wmRefresh
 unalias wmUnset
@@ -193,4 +211,4 @@ unalias foamVersion
 unalias foamPV
 
 
-#------------------------------------------------------------------------------
+#-------------------- vi: set ft=tcsh et sw=4 ts=4 sts=4: ---------------------
diff --git a/etc/config.sh/mac/CGAL b/etc/config.sh/mac/CGAL
new file mode 100644
index 000000000..fc6393cf7
--- /dev/null
+++ b/etc/config.sh/mac/CGAL
@@ -0,0 +1,47 @@
+# CGAL configuration for OS X
+
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+if [ "x$(_foamBrew)" = "xY" ]
+then
+    _prefix=$(_foamBrewPrefix)
+
+    boost_version="boost-$(_foamGetPackageVersion boost)"
+    cgal_version="CGAL-$(_foamGetPackageVersion cgal)"
+
+    export BOOST_ARCH_PATH="$_prefix/opt/boost"
+    export CGAL_ARCH_PATH="$_prefix/opt/cgal"
+    export MPFR_ARCH_PATH="$_prefix/opt/mpfr"
+    export GMP_ARCH_PATH="$_prefix/opt/gmp"
+
+    unset _prefix
+elif [ "x$(_foamPort)" = "xY" ]
+then
+    _prefix=$(_foamPortPrefix)
+
+    boost_version=$(_foamGetPackageVersion boost)
+    cgal_version=$(_foamGetPackageVersion cgal)
+
+    export BOOST_ARCH_PATH="$_prefix"
+    export CGAL_ARCH_PATH="$_prefix"
+    export GMP_ARCH_PATH="$_prefix"
+    export MPFR_ARCH_PATH="$_prefix"
+
+    unset _prefix
+else
+    boost_version=boost-unknown
+    cgal_version=CGAL-unknown
+
+    export BOOST_ARCH_PATH=/usr/local
+    export CGAL_ARCH_PATH=/usr/local
+fi
+
+if [ "$FOAM_VERBOSE" -a "$PS1" ]
+then
+    echo "Using CGAL and boost" 1>&2
+    echo "    $cgal_version at $CGAL_ARCH_PATH" 1>&2
+    echo "    $boost_version at $BOOST_ARCH_PATH" 1>&2
+fi
+unset boost_version cgal_version
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
+# vim: set ft=sh:
diff --git a/etc/config.sh/mac/functions b/etc/config.sh/mac/functions
new file mode 100644
index 000000000..f2a5d841e
--- /dev/null
+++ b/etc/config.sh/mac/functions
@@ -0,0 +1,134 @@
+# Additional functions for OS X
+
+if [ -z "$WM_BASH_FUNCTIONS_MAC" ]
+then
+    WM_BASH_FUNCTIONS_MAC=loaded
+
+    # Prefix to DYLD_LIBRARY_PATH and FOAM_DYLD_LIBRARY_PATH
+    _foamAddLib ()
+    {
+        while [ $# -ge 1 ]
+        do
+            export DYLD_LIBRARY_PATH=$1:$DYLD_LIBRARY_PATH
+            export FOAM_DYLD_LIBRARY_PATH=$1:$FOAM_DYLD_LIBRARY_PATH
+            shift
+        done
+    }
+
+    _foamBrew ()
+    {
+        if $(which -s brew)
+        then
+            echo Y
+            return 0
+        else
+            echo N
+            return 1
+        fi
+    }
+
+    _foamPort ()
+    {
+        if $(which -s port)
+        then
+            echo Y
+            return 0
+        else
+            echo N
+            return 1
+        fi
+    }
+
+    _foamPortPrefix ()
+    {
+        echo "$(dirname $(dirname $(which port)))"
+    }
+
+    _foamBrewPrefix ()
+    {
+        echo $(brew --prefix)
+    }
+
+    _foamGetPackageVersion ()
+    {
+        local version="?"
+        local ret=0
+        local pkg="$1"
+
+        if [ "x$(_foamBrew)" = "xY" ]
+        then
+            local prefix="$(_foamBrewPrefix)"
+            if [ -d "$prefix/opt/${pkg}64" -a "$WM_LABEL_SIZE" -eq 64 ]
+            then
+                version="$(basename $(readlink "$prefix/opt/${pkg}64"))"
+            elif [ -d "$prefix/opt/$pkg" ]
+            then
+                version="$(basename $(readlink "$prefix/opt/$pkg"))"
+            else
+                ret=1
+            fi
+        elif [ "x$(_foamPort)" = "xY" ]
+        then
+            version="0.0.x"
+        else
+            ret=1
+        fi
+        echo $version
+        return $ret
+    }
+
+    _foamGetPackageArchPath ()
+    {
+        local arch_path="/usr/local"
+        local ret=0
+        local pkg="$1"
+        if [ "x$(_foamBrew)" = "xY" ]
+        then
+            local prefix="$(_foamBrewPrefix)"
+            if [ -d "$prefix/opt/${pkg}64" -a "$WM_LABEL_SIZE" -eq 64 ]
+            then
+                arch_path="$prefix/opt/${pkg}64"
+            elif [ -d "$prefix/opt/$pkg" ]
+            then
+                arch_path="$prefix/opt/$pkg"
+            else
+                ret=1
+            fi
+        elif [ "x$(_foamPort)" = "xY" ]
+        then
+            arch_path="$(_foamPortPrefix)"
+        else
+            ret=1
+        fi
+        echo $arch_path
+        return $ret
+    }
+
+    _foam_increase_max_open_files ()
+    {
+        # Default value
+        local lim=4096
+
+        # Reset if parameter passed
+        [ -n "$1" ] && lim="$1"
+
+        # Silencing the errors
+        local current_limit=$(ulimit -n)
+        if [ "$current_limit" = "unlimited" ]
+        then
+            return 0
+        elif [ "$current_limit" -lt "$lim" ]
+        then
+            ulimit -n "$lim" > /dev/null 2>&1
+            return 0
+        fi
+        return 0
+    }
+else
+    unset WM_BASH_FUNCTIONS_MAC
+    unset _foamAddLib _foamBrew _foamPort _foamPortPrefix _foamBrewPrefix \
+        _foamGetPackageVersion _foamGetPackageArchPath \
+        _foam_increase_max_open_files
+fi
+
+# vim: set ft=sh:
diff --git a/etc/config.sh/mac/metis b/etc/config.sh/mac/metis
new file mode 100644
index 000000000..bb87346f7
--- /dev/null
+++ b/etc/config.sh/mac/metis
@@ -0,0 +1,44 @@
+#----------------------------------*-sh-*--------------------------------------
+# =========                 |
+# \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+#  \\    /   O peration     |
+#   \\  /    A nd           | Copyright (C) 2013-2016 OpenFOAM Foundation
+#    \\/     M anipulation  |
+#------------------------------------------------------------------------------
+# License
+#     This file is part of OpenFOAM.
+#
+#     OpenFOAM is free software: you can redistribute it and/or modify it
+#     under the terms of the GNU General Public License as published by
+#     the Free Software Foundation, either version 3 of the License, or
+#     (at your option) any later version.
+#
+#     OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+#     ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+#     FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+#     for more details.
+#
+#     You should have received a copy of the GNU General Public License
+#     along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+#
+# File
+#     etc/config.sh/metis
+#
+# Description
+#     Setup file for metis include/libraries.
+#     Sourced during wmake process only.
+#
+# Note
+#     A csh version is not needed, since the values here are only sourced
+#     during the wmake process
+#
+#------------------------------------------------------------------------------
+
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
+export METIS_VERSION=$(_foamGetPackageVersion metis)
+export METIS_ARCH_PATH=$(_foamGetPackageArchPath metis)
+
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
+#------------------------------------------------------------------------------
diff --git a/etc/config.sh/mac/paraview b/etc/config.sh/mac/paraview
new file mode 100644
index 000000000..cc69c1942
--- /dev/null
+++ b/etc/config.sh/mac/paraview
@@ -0,0 +1,18 @@
+_paraviews=(/Applications/[Pp][Aa][Rr][Aa][Vv][Ii][Ee][Ww]*.app)
+if test -d $_paraviews;
+then
+    [ "$FOAM_VERBOSE" -a "$PS1" ] && echo Using $_paraviews
+
+    paraview () {
+        local _paraviews=(/Applications/[Pp][Aa][Rr][Aa][Vv][Ii][Ee][Ww]*.app)
+        $_paraviews/Contents/MacOS/paraview "$@"
+    }
+
+    export -f paraview
+else
+    echo
+    echo "Please download binary Paraview release from"
+    echo "http://paraview.org and install it in /Applications"
+    echo "folder."
+    echo
+fi
diff --git a/etc/config.sh/mac/scotch b/etc/config.sh/mac/scotch
new file mode 100644
index 000000000..e62931c9b
--- /dev/null
+++ b/etc/config.sh/mac/scotch
@@ -0,0 +1,47 @@
+#----------------------------------*-sh-*--------------------------------------
+# =========                 |
+# \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+#  \\    /   O peration     |
+#   \\  /    A nd           | Copyright (C) 2011-2016 OpenFOAM Foundation
+#    \\/     M anipulation  |
+#------------------------------------------------------------------------------
+# License
+#     This file is part of OpenFOAM.
+#
+#     OpenFOAM is free software: you can redistribute it and/or modify it
+#     under the terms of the GNU General Public License as published by
+#     the Free Software Foundation, either version 3 of the License, or
+#     (at your option) any later version.
+#
+#     OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+#     ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+#     FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+#     for more details.
+#
+#     You should have received a copy of the GNU General Public License
+#     along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+#
+# File
+#     etc/config.sh/scotch
+#
+# Description
+#     Setup file for scotch include/libraries.
+#     Sourced during wmake process only.
+#
+# Note
+#     A csh version is not needed, since the values here are only sourced
+#     during the wmake process
+#
+#     If Scotch is to be entirely disabled, either rename this file or create
+#     an empty one with the same name at a user or site location.
+#
+#------------------------------------------------------------------------------
+
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
+export SCOTCH_VERSION=$(_foamGetPackageVersion scotch)
+export SCOTCH_ARCH_PATH=$(_foamGetPackageArchPath scotch)
+
+. $WM_PROJECT_DIR/etc/config.sh/mac/functions
+
+#------------------------------------------------------------------------------
diff --git a/etc/config.sh/mpi b/etc/config.sh/mpi
index b368cc51a..56bca560b 100644
--- a/etc/config.sh/mpi
+++ b/etc/config.sh/mpi
@@ -47,7 +47,7 @@ SYSTEMOPENMPI)
 
     # Bit of a hack: strip off 'lib' and hope this is the path to openmpi
     # include files and libraries.
-    export MPI_ARCH_PATH="${libDir%/*}"
+    _foam_on_macos || export MPI_ARCH_PATH="${libDir%/*}"
 
     _foamAddLib     $libDir
     unset libDir
@@ -263,7 +263,8 @@ esac
 # Dummy MPI already added to LD_LIBRARY_PATH and has no external libraries
 if [ "$FOAM_MPI" != dummy ]
 then
-    _foamAddLib $FOAM_LIBBIN/$FOAM_MPI:$FOAM_EXT_LIBBIN/$FOAM_MPI
+    _foamAddLib $FOAM_LIBBIN/$FOAM_MPI
+    [ -n "$FOAM_EXT_LIBBIN" ] && _foamAddLib $FOAM_EXT_LIBBIN/$FOAM_MPI
 fi
 
 
diff --git a/etc/config.sh/settings b/etc/config.sh/settings
index d48896bac..9a3bfba53 100644
--- a/etc/config.sh/settings
+++ b/etc/config.sh/settings
@@ -131,7 +131,12 @@ SunOS)
     export WM_CXXFLAGS='-mabi=64 -fPIC -std=c++0x'
     export WM_LDFLAGS='-mabi=64 -G0'
     ;;
-
+Darwin)
+    WM_ARCH=darwin64
+    export WM_COMPILER_ARCH=64
+    export WM_CC=clang
+    export WM_CXX=clang++
+    ;;
 *)    # An unsupported operating system
     /bin/cat <<USAGE 1>&2
 
@@ -159,7 +164,7 @@ export FOAM_APPBIN=$WM_PROJECT_DIR/platforms/$WM_OPTIONS/bin
 export FOAM_LIBBIN=$WM_PROJECT_DIR/platforms/$WM_OPTIONS/lib
 
 # External (ThirdParty) libraries
-export FOAM_EXT_LIBBIN=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/lib
+_foam_on_macos || export FOAM_EXT_LIBBIN=$WM_THIRD_PARTY_DIR/platforms/$WM_ARCH$WM_COMPILER$WM_PRECISION_OPTION$WM_LABEL_OPTION/lib
 
 # Site-specific directory
 siteDir="${WM_PROJECT_SITE:-$WM_PROJECT_INST_DIR/site}"
@@ -204,7 +209,12 @@ unset siteDir
 
 _foamAddPath $FOAM_USER_APPBIN:$FOAM_SITE_APPBIN:$FOAM_APPBIN
 # Make sure to pick up dummy versions of external libraries last
-_foamAddLib  $FOAM_USER_LIBBIN:$FOAM_SITE_LIBBIN:$FOAM_LIBBIN:$FOAM_EXT_LIBBIN:$FOAM_LIBBIN/dummy
+if [ -n "$FOAM_EXT_LIBBIN" ]
+then
+    _foamAddLib  $FOAM_USER_LIBBIN:$FOAM_SITE_LIBBIN:$FOAM_LIBBIN:$FOAM_EXT_LIBBIN:$FOAM_LIBBIN/dummy
+else
+    _foamAddLib  $FOAM_USER_LIBBIN:$FOAM_SITE_LIBBIN:$FOAM_LIBBIN:$FOAM_LIBBIN/dummy
+fi
 
 # Compiler settings
 # ~~~~~~~~~~~~~~~~~
@@ -297,4 +307,6 @@ system)
     ;;
 esac
 
+_foam_on_macos && _foam_increase_max_open_files 4096
+
 #------------------------------------------------------------------------------
diff --git a/etc/config.sh/unset b/etc/config.sh/unset
index d9c368034..6fc93b397 100644
--- a/etc/config.sh/unset
+++ b/etc/config.sh/unset
@@ -29,6 +29,9 @@
 #
 #------------------------------------------------------------------------------
 
+foamDarwin=0
+[ "$(uname -s)" = "Darwin" ] && foamDarwin=1
+
 # Clean standard environment variables (PATH, LD_LIBRARY_PATH, MANPATH)
 foamClean=$WM_PROJECT_DIR/bin/foamCleanPath
 [ -f "$foamClean" -a -x "$foamClean" ] || unset foamClean
@@ -46,6 +49,7 @@ unset WM_ARCH_OPTION
 unset WM_CC
 unset WM_CFLAGS
 unset WM_COMPILER
+unset WM_COMPILER_ARCH
 unset WM_COMPILER_TYPE
 unset WM_COMPILER_LIB_ARCH
 unset WM_COMPILE_OPTION
@@ -69,7 +73,7 @@ unset WM_PROJECT_SITE
 unset WM_PROJECT_USER_DIR
 unset WM_PROJECT_VERSION
 unset WM_SCHEDULER
-unset WM_THIRD_PARTY_DIR
+[ -n "$WM_THIRD_PARTY_DIR" ] && unset WM_THIRD_PARTY_DIR
 
 
 #------------------------------------------------------------------------------
@@ -138,12 +142,24 @@ unset FOAMY_HEX_MESH
 if [ -n "$foamClean" ]
 then
     cleaned=`$foamClean "$PATH" "$foamOldDirs"` && PATH="$cleaned"
-    cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"` && LD_LIBRARY_PATH="$cleaned"
+    if [ $foamDarwin ]
+    then
+        cleaned=`$foamClean "$FOAM_DYLD_LIBRARY_PATH" "$foamOldDirs"` && FOAM_DYLD_LIBRARY_PATH="$cleaned"
+        DYLD_LIBRARY_PATH=$FOAM_DYLD_LIBRARY_PATH
+    else
+        cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"` && LD_LIBRARY_PATH="$cleaned"
+    fi
     cleaned=`$foamClean "$MANPATH" "$foamOldDirs"` && MANPATH="$cleaned"
 fi
 
 
-[ -n "$LD_LIBRARY_PATH" ] || unset LD_LIBRARY_PATH
+if [ $foamDarwin ]
+then
+    [ -n "$DYLD_LIBRARY_PATH" ] || unset DYLD_LIBRARY_PATH
+    unset FOAM_DYLD_LIBRARY_PATH
+else
+    [ -n "$LD_LIBRARY_PATH" ] || unset LD_LIBRARY_PATH
+fi
 [ -n "$MANPATH" ] || unset MANPATH
 [ -n "$LD_PRELOAD" ] || unset LD_PRELOAD
 
@@ -159,6 +175,7 @@ unalias wm64
 unalias wm32
 unalias wmSP
 unalias wmDP
+unalias wmLP
 
 unalias wmUnset
 
@@ -181,4 +198,4 @@ unset foamVersion
 unset foamPV
 
 
-#------------------------------------------------------------------------------
+#--------------------- vi: set ft=sh et sw=4 ts=4 sts=4: ----------------------
diff --git a/etc/cshrc b/etc/cshrc
index a78f7a80c..b503787aa 100644
--- a/etc/cshrc
+++ b/etc/cshrc
@@ -51,6 +51,8 @@ setenv FOAM_INST_DIR `lsof +p $$ |& grep -oE '/.*'$WM_PROJECT'[^/]*/etc/cshrc' |
 # END OF (NORMAL) USER EDITABLE PART
 ################################################################################
 
+@ foamDarwin = ( `uname -s` == "Darwin" )
+
 # The default environment variables below can be overridden in a prefs.sh file
 # located in ~/.OpenFOAM/$WM_PROJECT_VERSION, ~/.OpenFOAM,
 # $FOAM_INST_DIR/site/$WM_PROJECT_VERSION or $FOAM_INST_DIR/site
@@ -62,6 +64,7 @@ setenv WM_COMPILER_TYPE system
 #- Compiler:
 #    WM_COMPILER = Gcc | Gcc48 ... Gcc62 | Clang | Icc
 setenv WM_COMPILER Gcc
+if ($foamDarwin) setenv WM_COMPILER Clang
 setenv WM_COMPILER_ARCH # defined but empty
 unsetenv WM_COMPILER_LIB_ARCH
 
@@ -128,7 +131,7 @@ setenv WM_PROJECT_DIR $WM_PROJECT_INST_DIR/$WM_PROJECT-$WM_PROJECT_VERSION
 
 # Location of third-party software
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
-setenv WM_THIRD_PARTY_DIR $WM_PROJECT_INST_DIR/ThirdParty-$WM_PROJECT_VERSION
+if (! $foamDarwin) setenv WM_THIRD_PARTY_DIR $WM_PROJECT_INST_DIR/ThirdParty-$WM_PROJECT_VERSION
 
 # Location of site-specific templates etc
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
@@ -184,9 +187,19 @@ end
 set foamClean=$WM_PROJECT_DIR/bin/foamCleanPath
 
 #- prevent local variables from shadowing setenv variables
-unset PATH MANPATH LD_LIBRARY_PATH LD_PRELOAD
+unset PATH MANPATH
+if ($foamDarwin) then
+    unset DYLD_LIBRARY_PATH FOAM_DYLD_LIBRARY_PATH
+else
+    unset LD_LIBRARY_PATH LD_PRELOAD
+endif
 
-if (! $?LD_LIBRARY_PATH ) setenv LD_LIBRARY_PATH ''
+if ($foamDarwin) then
+    if (! $?DYLD_LIBRARY_PATH ) setenv DYLD_LIBRARY_PATH ''
+    setenv FOAM_DYLD_LIBRARY_PATH $DYLD_LIBRARY_PATH
+else
+    if (! $?LD_LIBRARY_PATH ) setenv LD_LIBRARY_PATH ''
+endif
 if (! $?MANPATH) setenv MANPATH ''
 
 #- Clean PATH (path)
@@ -194,8 +207,16 @@ set cleaned=`$foamClean "$PATH" "$foamOldDirs"`
 if ( $status == 0 ) setenv PATH $cleaned
 
 #- Clean LD_LIBRARY_PATH
-set cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"`
-if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
+if ($foamDarwin) then
+    set cleaned=`$foamClean "$FOAM_DYLD_LIBRARY_PATH" "$foamOldDirs"`
+    if ( $status == 0 ) then
+        setenv FOAM_DYLD_LIBRARY_PATH $cleaned
+        setenv DYLD_LIBRARY_PATH $cleaned
+    endif
+else
+    set cleaned=`$foamClean "$LD_LIBRARY_PATH" "$foamOldDirs"`
+    if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
+endif
 
 #- Clean MANPATH
 set cleaned=`$foamClean "$MANPATH" "$foamOldDirs"`
@@ -210,7 +231,11 @@ _foamSource $WM_PROJECT_DIR/etc/config.csh/aliases
 # Source user setup files for optional packages
 # ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~
 _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.csh/mpi`
-_foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.csh/paraview`
+if ($_foamDarwin) then
+    _foamSource `$WM_PROJECT_DIR/bin/mac/foamEtcFile config.csh/paraview`
+else
+    _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.csh/paraview`
+endif
 _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.csh/ensight`
 
 
@@ -220,9 +245,17 @@ _foamSource `$WM_PROJECT_DIR/bin/foamEtcFile config.csh/ensight`
 set cleaned=`$foamClean "$PATH"`
 if ( $status == 0 ) setenv PATH $cleaned
 
-#- Clean LD_LIBRARY_PATH
-set cleaned=`$foamClean "$LD_LIBRARY_PATH"`
-if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
+#- Clean [FOAM_][DY]LD_LIBRARY_PATH
+if ($foamDarwin) then
+    set cleaned=`$foamClean "$FOAM_DYLD_LIBRARY_PATH"`
+    if ( $status == 0 ) then
+        setenv FOAM_DYLD_LIBRARY_PATH $cleaned
+        setenv DYLD_LIBRARY_PATH $cleaned
+    endif
+else
+    set cleaned=`$foamClean "$LD_LIBRARY_PATH"`
+    if ( $status == 0 ) setenv LD_LIBRARY_PATH $cleaned
+endif
 
 #- Clean MANPATH (trailing ':' to find system pages)
 set cleaned=`$foamClean "$MANPATH"`:
@@ -237,7 +270,7 @@ endif
 
 # cleanup environment:
 # ~~~~~~~~~~~~~~~~~~~~
-unset cleaned foamClean foamOldDirs
+unset cleaned foamClean foamOldDirs foamDarwin
 unalias _foamSource
 
-#------------------------------------------------------------------------------
+#--------------------- vi: set ft=tcsh et sw=4 ts=4 sts=4: ---------------------
diff --git a/src/Allwmake b/src/Allwmake
index b1eb0c0c1..a389f0153 100755
--- a/src/Allwmake
+++ b/src/Allwmake
@@ -12,11 +12,13 @@ wmakeCheckPwd "$WM_PROJECT_DIR/src" || {
     exit 1
 }
 
+[ "$(uname -s)" = "Darwin" ] || {
 [ -n "$FOAM_EXT_LIBBIN" ] || {
     echo "Allwmake error: FOAM_EXT_LIBBIN not set"
     echo "    Check the OpenFOAM entries in your dot-files and source them."
     exit 1
 }
+}
 
 # Update OpenFOAM version strings if required
 wmakePrintBuild -check || wrmo OpenFOAM/global/global.o 2>/dev/null
diff --git a/src/OSspecific/POSIX/POSIX.C b/src/OSspecific/POSIX/POSIX.C
index f8c840468..17cf058a5 100644
--- a/src/OSspecific/POSIX/POSIX.C
+++ b/src/OSspecific/POSIX/POSIX.C
@@ -56,7 +56,11 @@ Description
 #include <sys/socket.h>
 #include <netdb.h>
 #include <dlfcn.h>
+#if defined(darwin64)
+#include <mach-o/dyld.h>
+#else
 #include <link.h>
+#endif
 
 #include <netinet/in.h>
 
@@ -647,9 +651,15 @@ double Foam::highResLastModified
     fileStat fileStatus(name, checkVariants, followLink);
     if (fileStatus.isValid())
     {
+#if defined(darwin64)
+        return
+            fileStatus.status().st_mtime
+          + 1e-9*fileStatus.status().st_atimespec.tv_nsec;
+#else
         return
             fileStatus.status().st_mtime
           + 1e-9*fileStatus.status().st_atim.tv_nsec;
+#endif
     }
     else
     {
@@ -1241,6 +1251,20 @@ void* Foam::dlOpen(const fileName& lib, const bool check)
             << " : dlopen of " << lib << std::endl;
     }
     void* handle = ::dlopen(lib.c_str(), RTLD_LAZY|RTLD_GLOBAL);
+#if defined(darwin64)
+    if (handle == nullptr && lib.ext() == "so")
+    {
+        fileName fallback_lib = lib.lessExt() + ".dylib";
+        if (check)
+        {
+            WarningIn("dlOpen(const fileName&, const bool)")
+                << "dlOpen: using fallback library name "
+                << fallback_lib
+                << endl;
+        }
+        handle = ::dlopen(fallback_lib.c_str(), RTLD_LAZY|RTLD_GLOBAL);
+    }
+#endif
 
     if (!handle && check)
     {
@@ -1329,6 +1353,7 @@ bool Foam::dlSymFound(void* handle, const std::string& symbol)
 }
 
 
+#if ! defined(darwin64)
 static int collectLibsCallback
 (
     struct dl_phdr_info *info,
@@ -1341,12 +1366,20 @@ static int collectLibsCallback
     ptr->append(info->dlpi_name);
     return 0;
 }
+#endif
 
 
 Foam::fileNameList Foam::dlLoaded()
 {
     DynamicList<fileName> libs;
+#if defined(darwin64)
+    for(uint32_t cnt = 0; cnt < _dyld_image_count(); ++cnt)
+    {
+       libs.append(_dyld_get_image_name(cnt));
+    }
+#else
     dl_iterate_phdr(collectLibsCallback, &libs);
+#endif
     if (POSIX::debug)
     {
         std::cout
diff --git a/src/OSspecific/POSIX/clockTime/clockTime.H b/src/OSspecific/POSIX/clockTime/clockTime.H
index 4319b64b1..9d76efe22 100644
--- a/src/OSspecific/POSIX/clockTime/clockTime.H
+++ b/src/OSspecific/POSIX/clockTime/clockTime.H
@@ -37,6 +37,9 @@ SourceFiles
 #define clockTime_H
 
 #include <sys/types.h>
+#if defined(darwin64)
+#include <sys/time.h>
+#endif
 
 // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
 
diff --git a/src/OSspecific/POSIX/fileStat.C b/src/OSspecific/POSIX/fileStat.C
index ffb26041c..3cf965064 100644
--- a/src/OSspecific/POSIX/fileStat.C
+++ b/src/OSspecific/POSIX/fileStat.C
@@ -29,7 +29,9 @@ License
 
 #include <signal.h>
 #include <unistd.h>
+#if ! defined(darwin64)
 #include <sys/sysmacros.h>
+#endif
 
 // * * * * * * * * * * * * * * Static Data Members * * * * * * * * * * * * * //
 
diff --git a/src/OSspecific/POSIX/printStack.C b/src/OSspecific/POSIX/printStack.C
index 84003866d..487c17a2b 100644
--- a/src/OSspecific/POSIX/printStack.C
+++ b/src/OSspecific/POSIX/printStack.C
@@ -84,7 +84,11 @@ string pOpen(const string &cmd, label line=0)
 inline word addressToWord(const uintptr_t addr)
 {
     OStringStream nStream;
+    #if defined(darwin64)
+    nStream << "0x" << hex << uint64_t(addr);
+    #else
     nStream << "0x" << hex << addr;
+    #endif
     return nStream.str();
 }
 
@@ -100,9 +104,11 @@ void printSourceFileAndLine
     uintptr_t address = uintptr_t(addr);
     word myAddress = addressToWord(address);
 
+#if ! defined(darwin64)
     if (filename.ext() == "so")
+#endif
     {
-        // Convert address into offset into dynamic library
+        // Convert address into offset
         uintptr_t offset = uintptr_t(info->dli_fbase);
         intptr_t relativeAddress = address - offset;
         myAddress = addressToWord(relativeAddress);
@@ -112,13 +118,40 @@ void printSourceFileAndLine
     {
         string line = pOpen
         (
+#if defined(darwin64)
+            "echo 'image lookup -va " + myAddress + "'"
+          + " | xcrun lldb "
+          + "-O 'target create --no-dependents -a x86_64 "
+          + filename
+          + "' -o '"
+          + "target modules load -f "
+          + filename
+          + " __TEXT 0x0' 2> /dev/null"
+          + " | grep LineEntry"
+#else
             "addr2line -f --demangle=auto --exe "
           + filename
           + " "
           + myAddress,
             1
+#endif
         );
 
+#if defined(darwin64)
+        {
+            regExp re(".+LineEntry: .+: (.+):([0-9]+):[0-9]+");
+            List<std::string> groups;
+            if (!re.match(line, groups))
+            {
+                line = "??:0";
+            }
+            else
+            {
+                line = groups[0] + ":" + groups[1];
+            }
+        }
+#endif
+
         if (line == "")
         {
             os  << " addr2line failed";
@@ -156,9 +189,9 @@ fileName absolutePath(const char* fn)
 }
 
 
-word demangleSymbol(const char* sn)
+string demangleSymbol(const char* sn)
 {
-    word res;
+    string res;
     int st;
     char* cxx_sname = abi::__cxa_demangle
     (
@@ -170,12 +203,12 @@ word demangleSymbol(const char* sn)
 
     if (st == 0 && cxx_sname)
     {
-        res = word(cxx_sname);
+        res = string(cxx_sname);
         free(cxx_sname);
     }
     else
     {
-        res = word(sn);
+        res = string(sn);
     }
 
     return res;
diff --git a/src/OSspecific/POSIX/signals/sigFpe.C b/src/OSspecific/POSIX/signals/sigFpe.C
index f9c05bb04..ae9099d9d 100644
--- a/src/OSspecific/POSIX/signals/sigFpe.C
+++ b/src/OSspecific/POSIX/signals/sigFpe.C
@@ -37,6 +37,12 @@ License
     #include <malloc.h>
 #endif
 
+#if defined(darwin64)
+#include <xmmintrin.h>
+#include <sys/mman.h>
+#include <unistd.h>
+#endif
+
 #include <limits>
 
 // * * * * * * * * * * * * * * Static Data Members * * * * * * * * * * * * * //
@@ -50,6 +56,26 @@ void Foam::sigFpe::fillNan(UList<scalar>& lst)
 
 bool Foam::sigFpe::mallocNanActive_ = false;
 
+#if defined(darwin64)
+void *(*Foam::sigFpe::oldMalloc_)(struct _malloc_zone_t *zone, size_t size)
+    = NULL;
+
+void *Foam::sigFpe::nanMalloc_(struct _malloc_zone_t *zone, size_t size)
+{
+    void *result;
+
+    result = oldMalloc_(zone, size);
+
+    if (mallocNanActive_)
+    {
+        UList<scalar> lst(reinterpret_cast<scalar*>(result),
+                          size/sizeof(scalar));
+        fillNan(lst);
+    }
+
+    return result;
+}
+#endif
 
 #ifdef LINUX
 extern "C"
@@ -84,7 +110,7 @@ void* Foam::sigFpe::mallocNan(size_t size)
 #endif
 
 
-#ifdef LINUX_GNUC
+#if defined(LINUX_GNUC) || defined(darwin64)
 void Foam::sigFpe::sigHandler(int)
 {
     // Reset old handling
@@ -120,7 +146,7 @@ Foam::sigFpe::~sigFpe()
 {
     if (env("FOAM_SIGFPE"))
     {
-        #ifdef LINUX_GNUC
+        #if defined(LINUX_GNUC) || defined(darwin64)
         // Reset signal
         if
         (
@@ -137,10 +163,24 @@ Foam::sigFpe::~sigFpe()
 
     if (env("FOAM_SETNAN"))
     {
-        #ifdef LINUX
+        #if defined(LINUX) || defined(darwin64)
         // Disable initialisation to NaN
         mallocNanActive_ = false;
         #endif
+
+        #if defined(darwin64)
+        // Restoring old malloc handler
+        if (oldMalloc_ != NULL) {
+            malloc_zone_t *zone = malloc_default_zone();
+
+            if (zone != NULL)
+            {
+                mprotect(zone, getpagesize(), PROT_READ | PROT_WRITE);
+                zone->malloc = oldMalloc_;
+                mprotect(zone, getpagesize(), PROT_READ);
+            }
+        }
+        #endif
     }
 }
 
@@ -160,15 +200,21 @@ void Foam::sigFpe::set(const bool verbose)
     {
         bool supported = false;
 
-        #ifdef LINUX_GNUC
+        #if defined(LINUX_GNUC) || defined(darwin64)
         supported = true;
 
+        #if defined(LINUX_GNUC)
         feenableexcept
         (
             FE_DIVBYZERO
           | FE_INVALID
           | FE_OVERFLOW
         );
+        #endif  // LINUX_GNUC
+        #if defined(darwin64)
+        _mm_setcsr(_MM_MASK_MASK &~
+                   (_MM_MASK_OVERFLOW|_MM_MASK_INVALID|_MM_MASK_DIV_ZERO));
+        #endif
 
         struct sigaction newAction;
         newAction.sa_handler = sigHandler;
@@ -200,10 +246,33 @@ void Foam::sigFpe::set(const bool verbose)
 
     if (env("FOAM_SETNAN"))
     {
-        #ifdef LINUX
+        #if defined(LINUX) || defined(darwin64)
         mallocNanActive_ = true;
         #endif
 
+        #if defined(darwin64)
+        malloc_zone_t *zone = malloc_default_zone();
+
+        if (zone != NULL)
+        {
+            oldMalloc_ = zone->malloc;
+            if
+            (
+                mprotect(zone, getpagesize(), PROT_READ | PROT_WRITE) == 0
+            )
+            {
+                zone->malloc = nanMalloc_;
+                if
+                (
+                    mprotect(zone, getpagesize(), PROT_READ) == 0
+                )
+                {
+                    mallocNanActive_ = true;
+                }
+            }
+        }
+        #endif
+
         if (verbose)
         {
             if (mallocNanActive_)
diff --git a/src/OSspecific/POSIX/signals/sigFpe.H b/src/OSspecific/POSIX/signals/sigFpe.H
index b3fb45c9b..4cbcb2928 100644
--- a/src/OSspecific/POSIX/signals/sigFpe.H
+++ b/src/OSspecific/POSIX/signals/sigFpe.H
@@ -54,6 +54,10 @@ SourceFiles
     #define LINUX_GNUC
 #endif
 
+#if defined(darwin64)
+#include <malloc/malloc.h>
+#endif
+
 #include "UList.H"
 
 // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
@@ -75,11 +79,15 @@ class sigFpe
 
     // Static Data Members
 
-        #ifdef LINUX_GNUC
+        #if defined(LINUX_GNUC) || defined(darwin64)
         //- Handler for caught signals
         static void sigHandler(int);
         #endif
 
+        #if defined(darwin64)
+        static void *(*oldMalloc_)(struct _malloc_zone_t *zone, size_t size);
+        static void *nanMalloc_(struct _malloc_zone_t *zone, size_t size);
+        #endif
 
 public:
 
@@ -103,7 +111,7 @@ public:
         //- Flag to indicate mallocNan is enabled
         static bool mallocNanActive_;
 
-        #ifdef LINUX
+        #if defined(LINUX) || defined(darwin64)
         //- Malloc function which initialises to NaN
         static void* mallocNan(size_t size);
         #endif
diff --git a/src/OpenFOAM/Make/files b/src/OpenFOAM/Make/files
index cda6ab451..c6a21d21a 100644
--- a/src/OpenFOAM/Make/files
+++ b/src/OpenFOAM/Make/files
@@ -29,11 +29,13 @@ $(chars)/wchar/wcharIO.C
 primitives/direction/directionIO.C
 
 ints = primitives/ints
+$(ints)/uint16/uint16.C
 $(ints)/uint32/uint32.C
 $(ints)/uint32/uint32IO.C
 $(ints)/uint64/uint64.C
 $(ints)/uint64/uint64IO.C
 $(ints)/uint/uintIO.C
+$(ints)/int16/int16.C
 $(ints)/int32/int32.C
 $(ints)/int32/int32IO.C
 $(ints)/int64/int64.C
diff --git a/src/OpenFOAM/containers/Lists/UList/UList.C b/src/OpenFOAM/containers/Lists/UList/UList.C
index 6fc254498..898936cdf 100644
--- a/src/OpenFOAM/containers/Lists/UList/UList.C
+++ b/src/OpenFOAM/containers/Lists/UList/UList.C
@@ -28,6 +28,7 @@ License
 #include "contiguous.H"
 
 #include <algorithm>
+#include <random>
 
 // * * * * * * * * * * * * * * * Member Functions  * * * * * * * * * * * * * //
 
@@ -142,7 +143,7 @@ void Foam::stableSort(UList<T>& a, const Cmp& cmp)
 template<class T>
 void Foam::shuffle(UList<T>& a)
 {
-    std::random_shuffle(a.begin(), a.end());
+    std::shuffle(a.begin(), a.end(), std::default_random_engine());
 }
 
 
diff --git a/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.C b/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.C
index 742b8a049..a23a48678 100644
--- a/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.C
+++ b/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.C
@@ -346,7 +346,11 @@ Foam::fileName Foam::dynamicCode::codeRelPath() const
 
 Foam::fileName Foam::dynamicCode::libRelPath() const
 {
+#if defined(darwin64)
+    return codeRelPath()/libSubDir_/"lib" + codeName_ + ".dylib";
+#else
     return codeRelPath()/libSubDir_/"lib" + codeName_ + ".so";
+#endif
 }
 
 
diff --git a/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.H b/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.H
index 7aeacaf2a..def41b811 100644
--- a/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.H
+++ b/src/OpenFOAM/db/dynamicLibrary/dynamicCode/dynamicCode.H
@@ -219,7 +219,11 @@ public:
         //  Corresponds to codeRoot()/libSubDir()/lib\<codeName\>.so
         fileName libPath() const
         {
+            #if defined(darwin64)
+            return codeRoot_/libSubDir_/"lib" + codeName_ + ".dylib";
+            #else
             return codeRoot_/libSubDir_/"lib" + codeName_ + ".so";
+            #endif
         }
 
         //- Path for specified code name relative to \$FOAM_CASE
diff --git a/src/OpenFOAM/primitives/Scalar/doubleFloat.H b/src/OpenFOAM/primitives/Scalar/doubleFloat.H
index 8c783b4ce..366eb21e9 100644
--- a/src/OpenFOAM/primitives/Scalar/doubleFloat.H
+++ b/src/OpenFOAM/primitives/Scalar/doubleFloat.H
@@ -31,6 +31,46 @@ License
 
 #include <cmath>
 
+#if defined(darwin64)
+inline float j0f(float x) { return float(j0(double(x)));}
+inline float j1f(float x) { return float(j1(double(x)));}
+inline float y0f(float x) { return float(y0(double(x)));}
+inline float y1f(float x) { return float(y1(double(x)));}
+inline float jnf(const int n, const float s) { return float(jn(n, double(s))); }
+inline float ynf(const int n, const float s) { return float(yn(n, double(s))); }
+
+inline long double j0l(long double x)
+{
+    return static_cast<long double>(j0(static_cast<double>(x)));
+}
+
+inline long double j1l(long double x)
+{
+    return static_cast<long double>(j1(static_cast<double>(x)));
+}
+
+inline long double y0l(long double x)
+{
+    return static_cast<long double>(y0(static_cast<double>(x)));
+}
+
+inline long double y1l(float x)
+{
+    return static_cast<long double>(y1(static_cast<double>(x)));
+}
+
+inline long double jnl(const int n, const long double s)
+{
+    return static_cast<long double>(jn(n, static_cast<double>(s)));
+}
+
+inline long double ynl(const int n, const long double s)
+{
+    return static_cast<long double>(yn(n, static_cast<double>(s)));
+}
+
+#endif
+
 // * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
 
 namespace Foam
diff --git a/src/OpenFOAM/primitives/hashes/Hasher/Hasher.C b/src/OpenFOAM/primitives/hashes/Hasher/Hasher.C
index 65193a0b1..ce0ef8e14 100644
--- a/src/OpenFOAM/primitives/hashes/Hasher/Hasher.C
+++ b/src/OpenFOAM/primitives/hashes/Hasher/Hasher.C
@@ -457,7 +457,7 @@ static unsigned jenkins_hashbig
             case 4 : a += k[3]; [[fallthrough]];
             case 3 : a += static_cast<uint32_t>(k[2]) << 8; [[fallthrough]];
             case 2 : a += static_cast<uint32_t>(k[1]) << 16; [[fallthrough]];
-            case 1 : a += static_cast<uint32_t>(k[0]) << 24; [[fallthrough]];
+            case 1 : a += static_cast<uint32_t>(k[0]) << 24;
                 break;
             case 0 : return c;
         }
diff --git a/src/OpenFOAM/primitives/ints/int16/int16.C b/src/OpenFOAM/primitives/ints/int16/int16.C
new file mode 100644
index 000000000..240b8f63b
--- /dev/null
+++ b/src/OpenFOAM/primitives/ints/int16/int16.C
@@ -0,0 +1,48 @@
+/*---------------------------------------------------------------------------*\
+  =========                 |
+  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+   \\    /   O peration     |
+    \\  /    A nd           | Copyright (C) 2018 OpenCFD Ltd.
+     \\/     M anipulation  |
+-------------------------------------------------------------------------------
+License
+    This file is part of OpenFOAM.
+
+    OpenFOAM is free software: you can redistribute it and/or modify it
+    under the terms of the GNU General Public License as published by
+    the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+    for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+
+\*---------------------------------------------------------------------------*/
+
+#include "int16.H"
+#include "int32.H"
+#include "IOstreams.H"
+
+// * * * * * * * * * * * * * * * IOstream Operators  * * * * * * * * * * * * //
+
+Foam::Istream& Foam::operator>>(Istream& is, int16_t& val)
+{
+    int32_t parsed;
+    is >> parsed;
+
+    val = int16_t(parsed); // narrow
+    return is;
+}
+
+
+Foam::Ostream& Foam::operator<<(Ostream& os, const int16_t val)
+{
+    return (os << int32_t(val)); // widen
+}
+
+
+// ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/ints/int16/int16.H b/src/OpenFOAM/primitives/ints/int16/int16.H
new file mode 100644
index 000000000..b4f92c01c
--- /dev/null
+++ b/src/OpenFOAM/primitives/ints/int16/int16.H
@@ -0,0 +1,73 @@
+/*---------------------------------------------------------------------------*\
+  =========                 |
+  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+   \\    /   O peration     |
+    \\  /    A nd           | Copyright (C) 2018 OpenCFD Ltd.
+     \\/     M anipulation  |
+-------------------------------------------------------------------------------
+License
+    This file is part of OpenFOAM.
+
+    OpenFOAM is free software: you can redistribute it and/or modify it
+    under the terms of the GNU General Public License as published by
+    the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+    for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+
+Primitive
+    int16_t
+
+Description
+    16bit signed integer. I/O is done via an int32.
+
+SourceFiles
+    int16.C
+
+\*---------------------------------------------------------------------------*/
+
+#ifndef int16_H
+#define int16_H
+
+#include <cstdint>
+#include "word.H"
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+namespace Foam
+{
+
+class Istream;
+class Ostream;
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+//- Return a word representation of an int16
+inline word name(const int16_t val)
+{
+    // No stripping required
+    return word(std::to_string(int(val)), false);
+}
+
+
+// * * * * * * * * * * * * * * * IOstream Operators  * * * * * * * * * * * * //
+
+Istream& operator>>(Istream& is, int16_t& val);
+Ostream& operator<<(Ostream& os, const int16_t val);
+
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+} // End namespace Foam
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+#endif
+
+// ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/ints/int64/int64.H b/src/OpenFOAM/primitives/ints/int64/int64.H
index a9fe1c743..e8580d70a 100644
--- a/src/OpenFOAM/primitives/ints/int64/int64.H
+++ b/src/OpenFOAM/primitives/ints/int64/int64.H
@@ -68,6 +68,11 @@ bool read(const char*, int64_t&);
 Istream& operator>>(Istream&, int64_t&);
 Ostream& operator<<(Ostream&, const int64_t);
 
+#if defined(darwin64)
+Istream& operator>>(Istream& is, long& val);
+Ostream& operator<<(Ostream& os, const long val);
+#endif
+
 inline void writeEntry(Ostream& os, const int64_t value)
 {
     os << value;
diff --git a/src/OpenFOAM/primitives/ints/int64/int64IO.C b/src/OpenFOAM/primitives/ints/int64/int64IO.C
index 1b197b5c2..d49b8208b 100644
--- a/src/OpenFOAM/primitives/ints/int64/int64IO.C
+++ b/src/OpenFOAM/primitives/ints/int64/int64IO.C
@@ -99,5 +99,17 @@ Foam::Ostream& Foam::operator<<(Ostream& os, const int64_t i)
     return os;
 }
 
+#if defined(darwin64)
+Foam::Istream& Foam::operator>>(Istream& is, long& val)
+{
+    return operator>>(is, reinterpret_cast<int64_t&>(val));
+}
+
+Foam::Ostream& Foam::operator<<(Ostream& os, const long val)
+{
+    return (os << int64_t(val));
+}
+#endif
+
 
 // ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/ints/uint/uint.H b/src/OpenFOAM/primitives/ints/uint/uint.H
index 0698df700..fe3828e06 100644
--- a/src/OpenFOAM/primitives/ints/uint/uint.H
+++ b/src/OpenFOAM/primitives/ints/uint/uint.H
@@ -35,6 +35,7 @@ SourceFiles
 #ifndef uint_H
 #define uint_H
 
+#include "uint16.H"
 #include "uint32.H"
 #include "uint64.H"
 
diff --git a/src/OpenFOAM/primitives/ints/uint16/uint16.C b/src/OpenFOAM/primitives/ints/uint16/uint16.C
new file mode 100644
index 000000000..b98b7b1fe
--- /dev/null
+++ b/src/OpenFOAM/primitives/ints/uint16/uint16.C
@@ -0,0 +1,48 @@
+/*---------------------------------------------------------------------------*\
+  =========                 |
+  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+   \\    /   O peration     |
+    \\  /    A nd           | Copyright (C) 2018 OpenCFD Ltd.
+     \\/     M anipulation  |
+-------------------------------------------------------------------------------
+License
+    This file is part of OpenFOAM.
+
+    OpenFOAM is free software: you can redistribute it and/or modify it
+    under the terms of the GNU General Public License as published by
+    the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+    for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+
+\*---------------------------------------------------------------------------*/
+
+#include "uint16.H"
+#include "int32.H"
+#include "IOstreams.H"
+
+// * * * * * * * * * * * * * * * IOstream Operators  * * * * * * * * * * * * //
+
+Foam::Istream& Foam::operator>>(Istream& is, uint16_t& val)
+{
+    int32_t parsed;
+    is >> parsed;
+
+    val = uint16_t(parsed); // narrow
+    return is;
+}
+
+
+Foam::Ostream& Foam::operator<<(Ostream& os, const uint16_t val)
+{
+    return (os << int32_t(val)); // widen (fits as int32 without sign problem)
+}
+
+
+// ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/ints/uint16/uint16.H b/src/OpenFOAM/primitives/ints/uint16/uint16.H
new file mode 100644
index 000000000..9b23ce566
--- /dev/null
+++ b/src/OpenFOAM/primitives/ints/uint16/uint16.H
@@ -0,0 +1,73 @@
+/*---------------------------------------------------------------------------*\
+  =========                 |
+  \\      /  F ield         | OpenFOAM: The Open Source CFD Toolbox
+   \\    /   O peration     |
+    \\  /    A nd           | Copyright (C) 2018 OpenCFD Ltd.
+     \\/     M anipulation  |
+-------------------------------------------------------------------------------
+License
+    This file is part of OpenFOAM.
+
+    OpenFOAM is free software: you can redistribute it and/or modify it
+    under the terms of the GNU General Public License as published by
+    the Free Software Foundation, either version 3 of the License, or
+    (at your option) any later version.
+
+    OpenFOAM is distributed in the hope that it will be useful, but WITHOUT
+    ANY WARRANTY; without even the implied warranty of MERCHANTABILITY or
+    FITNESS FOR A PARTICULAR PURPOSE.  See the GNU General Public License
+    for more details.
+
+    You should have received a copy of the GNU General Public License
+    along with OpenFOAM.  If not, see <http://www.gnu.org/licenses/>.
+
+Primitive
+    uint16_t
+
+Description
+    16bit unsigned integer. I/O is done via an int32.
+
+SourceFiles
+    uint16.C
+
+\*---------------------------------------------------------------------------*/
+
+#ifndef uint16_H
+#define uint16_H
+
+#include <cstdint>
+#include "word.H"
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+namespace Foam
+{
+
+class Istream;
+class Ostream;
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+//- Return a word representation of a uint16
+inline word name(const uint16_t val)
+{
+    // No stripping required
+    return word(std::to_string(int(val)), false);
+}
+
+
+// * * * * * * * * * * * * * * * IOstream Operators  * * * * * * * * * * * * //
+
+Istream& operator>>(Istream& is, uint16_t& val);
+Ostream& operator<<(Ostream& os, const uint16_t val);
+
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+} // End namespace Foam
+
+// * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * * //
+
+#endif
+
+// ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/ints/uint64/uint64.H b/src/OpenFOAM/primitives/ints/uint64/uint64.H
index 146e6bd55..22cedd882 100644
--- a/src/OpenFOAM/primitives/ints/uint64/uint64.H
+++ b/src/OpenFOAM/primitives/ints/uint64/uint64.H
@@ -68,6 +68,10 @@ bool read(const char*, uint64_t&);
 Istream& operator>>(Istream&, uint64_t&);
 Ostream& operator<<(Ostream&, const uint64_t);
 
+#if defined(darwin64)
+Ostream& operator<<(Ostream& os, const unsigned long val);
+#endif
+
 //- Template specialisation for pTraits<uint64_t>
 template<>
 class pTraits<uint64_t>
diff --git a/src/OpenFOAM/primitives/ints/uint64/uint64IO.C b/src/OpenFOAM/primitives/ints/uint64/uint64IO.C
index 7c6c07708..a2d01e160 100644
--- a/src/OpenFOAM/primitives/ints/uint64/uint64IO.C
+++ b/src/OpenFOAM/primitives/ints/uint64/uint64IO.C
@@ -96,5 +96,13 @@ Foam::Ostream& Foam::operator<<(Ostream& os, const uint64_t i)
     return os;
 }
 
+#if defined(darwin64)
+Foam::Ostream& Foam::operator<<(Ostream& os, const unsigned long val)
+{
+    os << uint64_t(val);
+    return os;
+}
+#endif
+
 
 // ************************************************************************* //
diff --git a/src/OpenFOAM/primitives/strings/word/wordIOList.C b/src/OpenFOAM/primitives/strings/word/wordIOList.C
index b5fee5be9..60b3c4a32 100644
--- a/src/OpenFOAM/primitives/strings/word/wordIOList.C
+++ b/src/OpenFOAM/primitives/strings/word/wordIOList.C
@@ -53,7 +53,7 @@ void Foam::printTable
     {
         forAll(wll, i)
         {
-            columnWidth[j] = max(columnWidth[j], wll[i][j].size());
+            columnWidth[j] = std::max(columnWidth[j], wll[i][j].size());
         }
     }
 
diff --git a/src/fvAgglomerationMethods/Allwmake b/src/fvAgglomerationMethods/Allwmake
index dcef4328c..48abdf020 100755
--- a/src/fvAgglomerationMethods/Allwmake
+++ b/src/fvAgglomerationMethods/Allwmake
@@ -4,10 +4,14 @@ cd ${0%/*} || exit 1    # Run from this directory
 # Parse arguments for library compilation
 . $WM_PROJECT_DIR/wmake/scripts/AllwmakeParseArguments
 
-export ParMGridGen=$WM_THIRD_PARTY_DIR/ParMGridGen-1.0
-
-if [ -e "$FOAM_LIBBIN/libMGridGen.so" ]
+if [ "$(uname -s)" = "Darwin" ]
+then
+    [ -e "/usr/local/opt/parmgridgen/lib/libmgrid.a" -a \
+        "$WM_LABEL_SIZE" -ne "64" ] \
+        && wmake $targetType MGridGenGamgAgglomeration
+elif [ -e "$FOAM_LIBBIN/libMGridGen.so" ]
 then
+    export ParMGridGen=$WM_THIRD_PARTY_DIR/ParMGridGen-1.0
     wmake $targetType MGridGenGamgAgglomeration
 fi
 
diff --git a/src/fvAgglomerationMethods/MGridGenGamgAgglomeration/Make/options b/src/fvAgglomerationMethods/MGridGenGamgAgglomeration/Make/options
index 69f63dbe5..18d31d422 100644
--- a/src/fvAgglomerationMethods/MGridGenGamgAgglomeration/Make/options
+++ b/src/fvAgglomerationMethods/MGridGenGamgAgglomeration/Make/options
@@ -7,9 +7,15 @@ endif
 
 EXE_INC = \
     -I$(LIB_SRC)/finiteVolume/lnInclude \
-    -I$(ParMGridGen)/MGridGen/Lib/lnInclude \
-    -I$(ParMGridGen)/MGridGen/IMlib/lnInclude \
     $(TYPE_REAL)
 
-LIB_LIBS = \
-    -L$(FOAM_EXT_LIBBIN) -lMGridGen
+LIB_LIBS =
+
+ifeq ($(shell uname -s),Darwin)
+LIB_LIBS = -L/usr/local/opt/parmgridgen/lib -lmgrid
+EXE_INC += -I/usr/local/opt/parmgridgen/include
+else
+LIB_LIBS = -L$(FOAM_EXT_LIBBIN) -lMGridGen
+EXE_INC += -I$(ParMGridGen)/MGridGen/Lib/lnInclude
+EXE_INC += -I$(ParMGridGen)/MGridGen/IMlib/lnInclude
+endif
diff --git a/src/parallel/decompose/Allwmake b/src/parallel/decompose/Allwmake
index ea8550c8c..430392f5e 100755
--- a/src/parallel/decompose/Allwmake
+++ b/src/parallel/decompose/Allwmake
@@ -6,7 +6,9 @@ cd ${0%/*} || exit 1    # Run from this directory
 
 
 # Get SCOTCH_VERSION, SCOTCH_ARCH_PATH
-if settings=`$WM_PROJECT_DIR/bin/foamEtcFile config.sh/scotch`
+_scotchConf="config.sh/scotch"
+[ "$(uname -s)" = "Darwin" ] && _scotchConf="config.sh/mac/scotch"
+if settings=`$WM_PROJECT_DIR/bin/foamEtcFile "$_scotchConf"`
 then
     . $settings
     echo "    using SCOTCH_ARCH_PATH=$SCOTCH_ARCH_PATH"
@@ -15,6 +17,7 @@ else
     echo "    Error: no config.sh/scotch settings"
     echo
 fi
+unset _scotchConf
 
 
 # Define how to create an mpi-versioned library of $targetType
diff --git a/src/parallel/decompose/metisDecomp/Allwmake b/src/parallel/decompose/metisDecomp/Allwmake
index c52b1e52a..46df365ab 100755
--- a/src/parallel/decompose/metisDecomp/Allwmake
+++ b/src/parallel/decompose/metisDecomp/Allwmake
@@ -4,12 +4,20 @@ cd ${0%/*} || exit 1    # Run from this directory
 # Parse arguments for library compilation
 . $WM_PROJECT_DIR/wmake/scripts/AllwmakeParseArguments
 
+_so_ext="so"
+_metis_conf="config.sh/metis"
+if [ "$(uname -s)" = "Darwin" ]
+then
+    _so_ext="dylib"
+    _metis_conf="config.sh/mac/metis"
+fi
+
 # get METIS_VERSION, METIS_ARCH_PATH
-if settings=`$WM_PROJECT_DIR/bin/foamEtcFile config.sh/metis`
+if settings=`$WM_PROJECT_DIR/bin/foamEtcFile $_metis_conf`
 then
     . $settings
     echo "    using METIS_ARCH_PATH=$METIS_ARCH_PATH"
-    if [ -r $METIS_ARCH_PATH/lib/libmetis.so ]
+    if [ -r $METIS_ARCH_PATH/lib/libmetis.$_so_ext ]
     then
         wmake $targetType
     fi
@@ -19,5 +27,7 @@ else
     echo
 fi
 
+unset _so_ext _metis_conf
+
 
 #------------------------------------------------------------------------------
diff --git a/src/parallel/decompose/ptscotchDecomp/Make/options b/src/parallel/decompose/ptscotchDecomp/Make/options
index 2af0fddac..d800c63fb 100644
--- a/src/parallel/decompose/ptscotchDecomp/Make/options
+++ b/src/parallel/decompose/ptscotchDecomp/Make/options
@@ -3,15 +3,17 @@
 EXE_INC = \
     $(PFLAGS) $(PINC) \
     -I$(FOAM_SRC)/Pstream/mpi/lnInclude \
-    -I$(SCOTCH_ARCH_PATH)/include/$(FOAM_MPI) \
-    -I$(SCOTCH_ARCH_PATH)/include \
-    -I/usr/include/scotch \
     -I../decompositionMethods/lnInclude
 
 LIB_LIBS = \
-    -L$(SCOTCH_ARCH_PATH)/lib \
-    -L$(FOAM_EXT_LIBBIN)/$(FOAM_MPI) \
     -lptscotch \
     -lptscotcherrexit \
-    -lscotch \
-    -lrt
+    -lscotch
+
+ifneq ("$(SO)","dylib")
+EXE_INC += -I$(SCOTCH_ARCH_PATH)/include/$(FOAM_MPI) -I/usr/include/scotch
+LIB_LIBS += -L$(FOAM_EXT_LIBBIN)/$(FOAM_MPI) -lrt
+else
+EXE_INC += -I$(SCOTCH_ARCH_PATH)/include
+LIB_LIBS += -L$(SCOTCH_ARCH_PATH)/lib
+endif
diff --git a/src/parallel/decompose/scotchDecomp/Make/options b/src/parallel/decompose/scotchDecomp/Make/options
index 038f88d5f..bb8abb485 100644
--- a/src/parallel/decompose/scotchDecomp/Make/options
+++ b/src/parallel/decompose/scotchDecomp/Make/options
@@ -6,12 +6,14 @@
 EXE_INC = \
     $(PFLAGS) $(PINC) \
     -I$(SCOTCH_ARCH_PATH)/include \
-    -I/usr/include/scotch \
     -I../decompositionMethods/lnInclude
 
 LIB_LIBS = \
     -L$(SCOTCH_ARCH_PATH)/lib \
-    -L$(FOAM_EXT_LIBBIN) \
     -lscotch \
-    -lscotcherrexit \
-    -lrt
+    -lscotcherrexit
+
+ifneq ("$(shell uname -s)","Darwin")
+EXE_INC += -I/usr/include/scotch
+LIB_LIBS += -L$(FOAM_EXT_LIBBIN) -lrt
+endif
diff --git a/src/renumber/SloanRenumber/Make/options b/src/renumber/SloanRenumber/Make/options
index cf6e54861..e3b7efff8 100644
--- a/src/renumber/SloanRenumber/Make/options
+++ b/src/renumber/SloanRenumber/Make/options
@@ -5,7 +5,19 @@ EXE_INC = \
     -I$(LIB_SRC)/renumber/renumberMethods/lnInclude
 
 LIB_LIBS = \
-    -L$(BOOST_ARCH_PATH)/lib -lboost_system \
+    -L$(BOOST_ARCH_PATH)/lib \
     -lmeshTools \
     -ldecompositionMethods \
     -lrenumberMethods
+
+ifeq ("$(shell uname -s)","Darwin")
+SO = dylib
+else
+SO = so
+endif
+
+ifneq ("$(wildcard $(BOOST_ARCH_PATH)/lib/libboost_system-mt.$(SO))","")
+LIB_LIBS += -lboost_system-mt
+else
+LIB_LIBS += -lboost_system
+endif
diff --git a/src/thermophysicalModels/basic/basicThermo/basicThermo.C b/src/thermophysicalModels/basic/basicThermo/basicThermo.C
index f0b5bfffd..4209f5a35 100644
--- a/src/thermophysicalModels/basic/basicThermo/basicThermo.C
+++ b/src/thermophysicalModels/basic/basicThermo/basicThermo.C
@@ -140,7 +140,7 @@ Foam::wordList Foam::basicThermo::splitThermoName
         }
         else if ((endc = thermoName.find(',', beg)) != string::npos)
         {
-            end = min(endb, endc);
+            end = std::min(endb, endc);
         }
         else
         {
diff --git a/wmake/makefiles/general b/wmake/makefiles/general
index e549260f3..fb23b8ee2 100644
--- a/wmake/makefiles/general
+++ b/wmake/makefiles/general
@@ -88,7 +88,11 @@ endif
 LIB             = libNULL
 
 # Shared library extension
+ifeq ("$(shell uname -s)","Darwin")
+SO              = dylib
+else
 SO              = so
+endif
 
 # Project executable
 EXE             = $(WM_PROJECT).out
diff --git a/wmake/rules/General/transform b/wmake/rules/General/transform
index efb86df86..f7caf9384 100644
--- a/wmake/rules/General/transform
+++ b/wmake/rules/General/transform
@@ -31,7 +31,6 @@ $(OBJECTS_DIR)/%.dep : %
 	@$(WMAKE_BIN)/wmkdep \
 		-R '$(OBJECTS_DIR)/' '$$(OBJECTS_DIR)/' \
 		-R '$(WM_PROJECT_DIR)/' '$$(WM_PROJECT_DIR)/' \
-		-R '$(WM_THIRD_PARTY_DIR)/' '$$(WM_THIRD_PARTY_DIR)/' \
 		$(LIB_HEADER_DIRS) $< $@
 
 #------------------------------------------------------------------------------
diff --git a/wmake/rules/darwin64Clang/CGAL b/wmake/rules/darwin64Clang/CGAL
new file mode 100644
index 000000000..a1e88161d
--- /dev/null
+++ b/wmake/rules/darwin64Clang/CGAL
@@ -0,0 +1,9 @@
+CGAL_INC = \
+    -DCGAL_NO_DEPRECATED_CODE \
+    -DCGAL_HEADER_ONLY \
+    -I$(CGAL_ARCH_PATH)/include \
+    -I$(MPFR_ARCH_PATH)/include \
+    -I$(GMP_ARCH_PATH)/include \
+    -I$(BOOST_ARCH_PATH)/include
+
+CGAL_LIBS = -L$(GMP_ARCH_PATH)/lib -L$(MPFR_ARCH_PATH)/lib -lgmp -lmpfr
diff --git a/wmake/rules/darwin64Clang/bison b/wmake/rules/darwin64Clang/bison
new file mode 100644
index 000000000..3d11bf122
--- /dev/null
+++ b/wmake/rules/darwin64Clang/bison
@@ -0,0 +1,13 @@
+SUFFIXES += .y .Y
+
+ytoo = $E $(call QUIET_MESSAGE,bison,$(<F)) \
+    $(WM_SCHEDULER) xcrun bison -v -d -y $< $(AND) \
+    mv y.tab.c $(@D)/$(<F).c $(AND) \
+    mv y.tab.h $(@D)/$(<F).h $(AND) \
+    $(cc) $(cFLAGS) -c  $(@D)/$(<F).c -o $@
+
+Ytoo = $E $(call QUIET_MESSAGE,bison,$(<F)) \
+    $(WM_SCHEDULER) xcrun bison -v -d -y $< $(AND) \
+    mv y.tab.c $(@D)/$(<F).C $(AND) \
+    mv y.tab.h $(@D)/$(<F).H $(AND) \
+    $(CC) $(c++FLAGS) -c  $(@D)/$(<F).C -o $@
diff --git a/wmake/rules/darwin64Clang/c b/wmake/rules/darwin64Clang/c
new file mode 100644
index 000000000..3ce40f206
--- /dev/null
+++ b/wmake/rules/darwin64Clang/c
@@ -0,0 +1,23 @@
+SUFFIXES += .c
+
+cWARN        = -Wall
+
+cc          = xcrun cc -arch x86_64
+
+include $(RULES)/c$(WM_COMPILE_OPTION)
+
+cFLAGS      = $(GFLAGS) $(cWARN) $(cOPT) $(cDBUG) $(LIB_HEADER_DIRS) -fPIC
+
+ifneq ("$(OSX_SDK_PATH)","")
+cFLAGS += -isysroot $(OSX_SDK_PATH)
+endif
+
+ctoo        = $(WM_SCHEDULER) $(cc) $(cFLAGS) -c $< -o $@
+
+LINK_LIBS   = $(cDBUG)
+
+LINKLIBSO   = $(cc) -Wl,-dylib,-undefined,dynamic_lookup,-w
+
+LINKEXE     = $(cc) -Wl,-execute,-undefined,dynamic_lookup,-w
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/c++ b/wmake/rules/darwin64Clang/c++
new file mode 100644
index 000000000..158758097
--- /dev/null
+++ b/wmake/rules/darwin64Clang/c++
@@ -0,0 +1,35 @@
+SUFFIXES += .C
+SUFFIXES += .cxx
+SUFFIXES += .cc
+SUFFIXES += .cpp
+
+c++WARN     = -Wall -Wextra -Wno-unused-parameter -Wno-overloaded-virtual \
+              -Wno-unused-variable -Wno-unused-local-typedef -Wno-invalid-offsetof \
+	      -Wno-deprecated-register -Wno-undefined-var-template
+
+c++LESSWARN = -Wno-shift-negative-value
+
+CC          = xcrun c++ -arch x86_64 -std=c++14
+
+include $(RULES)/c++$(WM_COMPILE_OPTION)
+
+ptFLAGS     = -DNoRepository -ftemplate-depth-100
+
+c++FLAGS    = $(GFLAGS) $(c++WARN) $(c++OPT) $(c++DBUG) $(ptFLAGS) $(LIB_HEADER_DIRS) -fPIC
+
+ifneq ("$(OSX_SDK_PATH)","")
+c++FLAGS += -isysroot $(OSX_SDK_PATH)
+endif
+
+Ctoo        = $(WM_SCHEDULER) $(CC) $(c++FLAGS) -c $< -o $@
+cxxtoo      = $(Ctoo)
+cctoo       = $(Ctoo)
+cpptoo      = $(Ctoo)
+
+LINK_LIBS   = $(c++DBUG)
+
+LINKLIBSO   = $(CC) $(c++FLAGS) -Wl,-dylib,-undefined,dynamic_lookup,-w
+
+LINKEXE     = $(CC) $(c++FLAGS) -Wl,-execute,-undefined,dynamic_lookup,-w
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/c++Debug b/wmake/rules/darwin64Clang/c++Debug
new file mode 100644
index 000000000..0ed0af6c0
--- /dev/null
+++ b/wmake/rules/darwin64Clang/c++Debug
@@ -0,0 +1,4 @@
+c++DBUG    = -g -DFULLDEBUG
+c++OPT      = -O0
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/c++Opt b/wmake/rules/darwin64Clang/c++Opt
new file mode 100644
index 000000000..db785436b
--- /dev/null
+++ b/wmake/rules/darwin64Clang/c++Opt
@@ -0,0 +1,5 @@
+#c++DBUG     = -O0 -DFULLDEBUG -g
+c++DBUG     =
+c++OPT      = -O3
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/c++Prof b/wmake/rules/darwin64Clang/c++Prof
new file mode 100644
index 000000000..f86e0d9f9
--- /dev/null
+++ b/wmake/rules/darwin64Clang/c++Prof
@@ -0,0 +1,4 @@
+c++DBUG    = -gline-tables-only
+c++OPT     = -O2
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/cDebug b/wmake/rules/darwin64Clang/cDebug
new file mode 100644
index 000000000..d45598959
--- /dev/null
+++ b/wmake/rules/darwin64Clang/cDebug
@@ -0,0 +1,4 @@
+cDBUG       = -g -DFULLDEBUG
+cOPT        = -O0
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/cOpt b/wmake/rules/darwin64Clang/cOpt
new file mode 100644
index 000000000..0c2e03c5e
--- /dev/null
+++ b/wmake/rules/darwin64Clang/cOpt
@@ -0,0 +1,4 @@
+cDBUG       =
+cOPT        = -O3
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/cProf b/wmake/rules/darwin64Clang/cProf
new file mode 100644
index 000000000..864f043d5
--- /dev/null
+++ b/wmake/rules/darwin64Clang/cProf
@@ -0,0 +1,4 @@
+cDBUG       = -pg
+cOPT        = -O2
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/flex b/wmake/rules/darwin64Clang/flex
new file mode 100644
index 000000000..a0ef4ee25
--- /dev/null
+++ b/wmake/rules/darwin64Clang/flex
@@ -0,0 +1,5 @@
+SUFFIXES += .l
+
+ltoo = $E $(call QUIET_MESSAGE,flex,$(<F)) \
+    $(WM_SCHEDULER) xcrun flex -o $(@D)/$(<F).c $< $(AND) \
+    $(cc) $(cFLAGS) -c  $(@D)/$(<F).c -o $@
diff --git a/wmake/rules/darwin64Clang/flex++ b/wmake/rules/darwin64Clang/flex++
new file mode 100644
index 000000000..a9b72667c
--- /dev/null
+++ b/wmake/rules/darwin64Clang/flex++
@@ -0,0 +1,5 @@
+SUFFIXES += .L
+
+Ltoo = $E $(call QUIET_MESSAGE,flex++,$(<F)) \
+    $(WM_SCHEDULER) xcrun flex -+ -o$(@D)/$(<F).C -f $< $(AND) \
+    $(CC) $(c++FLAGS) $(c++LESSWARN) -c $(@D)/$(<F).C -o $@
diff --git a/wmake/rules/darwin64Clang/general b/wmake/rules/darwin64Clang/general
new file mode 100644
index 000000000..e3d90086e
--- /dev/null
+++ b/wmake/rules/darwin64Clang/general
@@ -0,0 +1,16 @@
+CPP        = xcrun cpp -traditional-cpp $(GFLAGS)
+AR         = xcrun ar
+RANLIB     = xcrun ranlib
+CPP        = xcrun cpp
+LD         = xcrun ld
+
+PROJECT_LIBS = -l$(WM_PROJECT) -ldl
+
+OSX_SDK_PATH = $(shell xcrun --show-sdk-path)
+
+include $(GENERAL_RULES)/standard
+
+include $(RULES)/c
+include $(RULES)/c++
+
+#----------------------------- vi: set ft=make: -------------------------------
diff --git a/wmake/rules/darwin64Clang/yacc b/wmake/rules/darwin64Clang/yacc
new file mode 100644
index 000000000..d96342637
--- /dev/null
+++ b/wmake/rules/darwin64Clang/yacc
@@ -0,0 +1,13 @@
+SUFFIXES += .y .Y
+
+ytoo = $E $(call QUIET_MESSAGE,yacc,$(<F)) \
+    $(WM_SCHEDULER) xcrun yacc -v -d $< $(AND) \
+    mv y.tab.c $(@D)/$(<F).c $(AND) \
+    mv y.tab.h $(@D)/parser.h $(AND) \
+    $(CC) $(c++FLAGS) -c $(@D)/$(<F).c -o $@
+
+Ytoo = $E $(call QUIET_MESSAGE,yacc,$(<F)) \
+    $(WM_SCHEDULER) xcrun yacc -v -d $< $(AND) \
+    mv y.tab.c $(@D)/$(<F).C $(AND) \
+    mv y.tab.h $(@D)/parser.H $(AND) \
+    $(CC) $(c++FLAGS) -c $(@D)/$(<F).C -o $@
diff --git a/wmake/src/Makefile b/wmake/src/Makefile
index a0d87a84e..16279c000 100644
--- a/wmake/src/Makefile
+++ b/wmake/src/Makefile
@@ -52,6 +52,8 @@ WM_COMPILE_OPTION = Opt
 GENERAL_RULES   = $(WM_DIR)/rules/General
 include $(GENERAL_RULES)/general
 
+cFLAGS += -Wno-unused-function
+
 
 #------------------------------------------------------------------------------
 # Targets
diff --git a/wmake/wmake b/wmake/wmake
index 307114655..24becb484 100755
--- a/wmake/wmake
+++ b/wmake/wmake
@@ -122,6 +122,11 @@ useAllCores()
         WM_NCOMPPROCS=1
     fi
 
+    if [ -n "$(sysctl -en hw.ncpu)" ]
+    then
+        WM_NCOMPPROCS=$(sysctl -en hw.ncpu)
+    fi
+
     export WM_NCOMPPROCS
 }
 
diff --git a/wmake/wmakeLnIncludeAll b/wmake/wmakeLnIncludeAll
index 6a119d259..0bf0eaed1 100755
--- a/wmake/wmakeLnIncludeAll
+++ b/wmake/wmakeLnIncludeAll
@@ -128,6 +128,7 @@ then
     for d in $includeDirs
     do [ ! -d "$d" ]
        path=$(eval echo "$d")
+       [ -d "$path" ] || continue
        if [ ! -d "$path/lnInclude" ]
        then
            [ $printed ] || echo "$Script: running wmakeLnInclude on dependent libraries:"
